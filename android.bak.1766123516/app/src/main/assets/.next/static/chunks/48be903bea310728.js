(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88289,e=>{"use strict";e.i(47167);var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(70065),r=e.i(67881),i=e.i(23750),n=e.i(62870),d=e.i(10708),c=e.i(84762),o=e.i(87336),m=e.i(76686),u=e.i(30374),h=e.i(78892),x=e.i(7233),g=e.i(55436),p=e.i(87316),j=e.i(12426),v=e.i(31278),f=e.i(67236),b=e.i(78716),N=e.i(86536);let _=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var S=e.i(27612),w=e.i(61911),C=e.i(78583),y=e.i(56272),D=e.i(25652),T=e.i(3116);e.i(73708),e.i(94008);var k=e.i(82293),I=e.i(39951),P=e.i(20755),E=e.i(73297),F=e.i(61668),A=e.i(94179),B=e.i(7855),L=e.i(95187),M=(0,L.createServerReference)("40a4dbbba46d42778ca13443447c1eace251478be0",L.callServer,void 0,L.findSourceMapURL,"createMilestone"),V=(0,L.createServerReference)("60e5c3f9efb3e2af71ede94483ceab393987c93573",L.callServer,void 0,L.findSourceMapURL,"updateMilestoneStatus"),R=(0,L.createServerReference)("40976afb0bc8b7c7b1a06e4d2172dc94d38c18b70d",L.callServer,void 0,L.findSourceMapURL,"deleteMilestone");function U(){let{user:L}=(0,F.useAuth)(),U=(0,a.useSearchParams)(),[q,z]=(0,s.useState)([]),[H,O]=(0,s.useState)([]),[Y,G]=(0,s.useState)({}),[$,W]=(0,s.useState)({}),[K,Q]=(0,s.useState)({}),[J,X]=(0,s.useState)(!0),[Z,ee]=(0,s.useState)(""),[et,es]=(0,s.useState)("all"),[ea,el]=(0,s.useState)("all"),[er,ei]=(0,s.useState)(!1),[en,ed]=(0,s.useState)(!1),[ec,eo]=(0,s.useState)(null),[em,eu]=(0,s.useState)(!1),[eh,ex]=(0,s.useState)(!1),[eg,ep]=(0,s.useState)(!1),[ej,ev]=(0,s.useState)(!1),[ef,eb]=(0,s.useState)({}),[eN,e_]=(0,s.useState)([]),[eS,ew]=(0,s.useState)(""),[eC,ey]=(0,s.useState)(""),[eD,eT]=(0,s.useState)({title:"",description:"",due_date:""}),ek=[{value:"pending",label:"Pending"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"blocked",label:"Blocked"}],[eI,eP]=(0,s.useState)({name:"",client_id:"",description:"",service_type:"video_production",budget:"",start_date:"",deadline:"",status:"planning",progress_percentage:0}),[eE,eF]=(0,s.useState)({}),[eA,eB]=(0,s.useState)(null),[eL,eM]=(0,s.useState)(!1),[eV,eR]=(0,s.useState)(!1),[eU,eq]=(0,s.useState)({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),[ez,eH]=(0,s.useState)({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),[eO,eY]=(0,s.useState)({}),[eG,e$]=(0,s.useState)({}),[eW,eK]=(0,s.useState)(""),[eQ,eJ]=(0,s.useState)(""),[eX,eZ]=(0,s.useState)(!1),[e0,e2]=(0,s.useState)({name:"",client_id:"",description:"",service_type:"video_production",budget:"",start_date:"",deadline:"",status:"planning"});async function e1(){m.debug.log("FETCH_DATA","Starting data fetch...");let e=(0,P.createClient)();X(!0);try{let t=[];if(console.log("[ProjectsPage] ðŸ”µ FETCH START - User:",L?.id,"Email:",L?.email,"Role:",L?.role),L?.role==="project_manager"||L?.role==="employee"){console.log("[ProjectsPage] ðŸ”· Employee/PM fetch mode"),console.log("[ProjectsPage] Fetching projects created by:",L.id);let{data:s,error:a}=await e.from("projects").select("*, clients(company_name, contact_person)").eq("created_by",L.id).order("created_at",{ascending:!1});if(console.log("[ProjectsPage] Created projects result:",{count:s?.length,error:a}),a)throw a;console.log("[ProjectsPage] Fetching project_team entries for user:",L.id);let{data:l,error:r}=await e.from("project_team").select("projects(*, clients(company_name, contact_person))").eq("user_id",L.id);console.log("[ProjectsPage] Team projects result:",{count:l?.length,error:r}),r&&console.warn("[ProjectsPage] âš ï¸ Team projects query failed:",r);let i=[...s||[]],n=(l||[]).map(e=>e.projects).filter(Boolean);console.log("[ProjectsPage] Before dedup - created:",i.length,"from team:",n.length),n.forEach(e=>{i.find(t=>t.id===e.id)||i.push(e)}),console.log("[ProjectsPage] After dedup - total projects:",i.length),i.forEach(e=>console.log("[ProjectsPage] Project:",e.id,e.name)),t=i}else{console.log("[ProjectsPage] ðŸ”· Admin fetch mode - fetching ALL projects");let{data:s,error:a}=await e.from("projects").select("*, clients(company_name, contact_person)").order("created_at",{ascending:!1});if(console.log("[ProjectsPage] All projects result:",{count:s?.length,error:a}),a)throw a;t=s||[]}console.log("[ProjectsPage] âœ… Total projects to display:",t.length),m.debug.success("FETCH_DATA","Projects fetched",{count:t?.length});let{data:s,error:a}=await e.from("clients").select("*").eq("status","active").order("company_name");if(a)throw a;if(m.debug.success("FETCH_DATA","Clients fetched",{count:s?.length}),z(t||[]),O(s||[]),t&&t.length>0){let s=t.map(e=>e.id),{data:a,error:l}=await e.from("project_files").select("*").in("project_id",s).order("created_at",{ascending:!1});if(l)throw l;let r=(a||[]).reduce((e,t)=>(e[t.project_id]=e[t.project_id]||[],e[t.project_id].push(t),e),{});G(r)}if(t&&t.length>0){let s=t.map(e=>e.id),{data:a,error:l}=await e.from("milestones").select("*").in("project_id",s).order("position",{ascending:!0}).order("due_date",{ascending:!0});if(l)console.warn("Milestones table not available:",l.message);else{let e=(a||[]).reduce((e,t)=>(e[t.project_id]=e[t.project_id]||[],e[t.project_id].push(t),e),{});W(e)}}if(t&&t.length>0){let s=[...new Set(t.map(e=>e.created_by).filter(Boolean))];if(s.length>0){let{data:t,error:a}=await e.from("users").select("*").in("id",s);if(a)throw a;let l=(t||[]).reduce((e,t)=>(e[t.id]=t,e),{});Q(l)}}if(t&&t.length>0){m.debug.log("FETCH_DATA","Fetching team members for projects...",{projectIds:t.map(e=>e.id)});let s=t.map(e=>e.id),{data:a,error:l}=await e.from("project_team").select("project_id, user_id, user:users!user_id(id, email, full_name, avatar_url, role)").in("project_id",s);if(l)m.debug.warn("FETCH_DATA","Team fetch error:",l),console.warn("Project team table not available:",l.message);else{m.debug.log("FETCH_DATA","Team data received",{rawCount:a?.length});let e=(a||[]).reduce((e,t)=>(e[t.project_id]||(e[t.project_id]=[]),t.user&&e[t.project_id].push(t.user),e),{});m.debug.success("FETCH_DATA","Team members mapped",{projectsWithTeam:Object.keys(e).length,teamMap:e}),eb(e)}}if(L?.role==="admin"||L?.role==="project_manager"){let{data:t,error:s}=await e.from("users").select("*").order("full_name",{ascending:!0,nullsFirst:!1});if(s)console.error("Error fetching users:",s);else{let e=(t||[]).filter(e=>"admin"===e.role||"project_manager"===e.role||"employee"===e.role);e_(e)}}}catch(e){console.error("Error fetching data:",{message:e?.message,code:e?.code,details:e?.details,hint:e?.hint})}finally{X(!1)}}async function e3(e){if(e.preventDefault(),en)return;ed(!0);let t=(0,P.createClient)();try{let{data:e,error:s}=await t.from("projects").insert([{name:e0.name,client_id:e0.client_id,description:e0.description,service_type:e0.service_type,budget:e0.budget?parseFloat(e0.budget):null,start_date:e0.start_date||null,deadline:e0.deadline||null,status:e0.status,progress_percentage:0,created_by:L?.id}]).select();if(s)throw s;e2({name:"",client_id:"",description:"",service_type:"video_production",budget:"",start_date:"",deadline:"",status:"planning"}),ei(!1),await e1()}catch(e){console.error("Error creating project:",e),alert(e.message||"Failed to create project")}finally{ed(!1)}}async function e4(e){if(e.preventDefault(),ec&&!en){ed(!0);try{let{data:e,error:t}=await M({project_id:ec.id,title:eD.title,description:eD.description,due_date:eD.due_date||null,status:"pending"});if(t)throw Error(t);eT({title:"",description:"",due_date:""}),ex(!1),e&&W(t=>({...t,[ec.id]:[e,...t[ec.id]||[]]}))}catch(e){console.error("Error adding milestone:",{message:e?.message,code:e?.code,details:e?.details,hint:e?.hint}),alert(e?.message||"Failed to add milestone. The milestones table may not exist yet.")}finally{ed(!1)}}}async function e8(e,t,s){let{error:a,data:l}=await V(t,s);a?alert(a):l&&W(s=>({...s,[e]:(s[e]||[]).map(e=>e.id===t?{...e,status:l.status}:e)}))}async function e5(e,t){if(!confirm("Delete this milestone?"))return;let{error:s}=await R(t);s?alert(s):W(s=>({...s,[e]:(s[e]||[]).filter(e=>e.id!==t)}))}async function e6(e){if(e.preventDefault(),!ec||!eS||en)return;if(m.debug.log("ASSIGN_TEAM","Start team assignment",{projectId:ec.id,userId:eS}),console.log("=== ASSIGN TEAM MEMBER START ==="),console.log("Selected Project ID:",ec.id),console.log("Selected User ID:",eS),console.log("Current projectTeam state:",ef),ef[ec.id]?.find(e=>e.id===eS)){m.debug.warn("ASSIGN_TEAM","User already assigned",{userId:eS}),alert("This team member is already assigned to this project");return}ed(!0);let t=(0,P.createClient)();try{let{error:e}=await t.from("project_team").insert({project_id:ec.id,user_id:eS,role:eC||null,assigned_by:L?.id});if(e){if("23505"===e.code)throw Error("This team member is already assigned to this project");throw e}m.debug.success("ASSIGN_TEAM","Team member inserted",{projectId:ec.id,userId:eS}),console.log("Team member inserted successfully"),ew(""),ey(""),m.debug.log("ASSIGN_TEAM","Fetching updated team members..."),console.log("Fetching updated team members...");let s=await e9(ec.id);m.debug.success("ASSIGN_TEAM","Members updated",{members:s.map(e=>e.email)}),console.log("Updated members returned:",s),console.log("=== ASSIGN TEAM MEMBER END ===")}catch(e){m.debug.error("ASSIGN_TEAM","Assignment failed",e),console.error("Error assigning team member:",{message:e?.message,code:e?.code,details:e?.details,hint:e?.hint}),alert(e?.message||"Failed to assign team member")}finally{ed(!1)}}async function e7(e){if(!ec||!confirm("Remove this team member from the project?"))return;let t=(0,P.createClient)();try{let{error:s}=await t.from("project_team").delete().eq("project_id",ec.id).eq("user_id",e);if(s)throw s;eb(t=>({...t,[ec.id]:t[ec.id]?.filter(t=>t.id!==e)||[]}))}catch(e){console.error("Error removing team member:",e),alert("Failed to remove team member")}}async function e9(e){let t=(0,P.createClient)();try{let{data:s,error:a}=await t.from("project_team").select("*, user:users!user_id(id, email, full_name, avatar_url, role)").eq("project_id",e);if(a)throw m.debug.error("FETCH_TEAM","Query error:",a),console.error("Error fetching team members:",a),a;m.debug.log("FETCH_TEAM","Raw data from query:",{projectId:e,count:s?.length}),console.log("Fetched team data:",s);let l=(s||[]).map(e=>e.user).filter(Boolean);return m.debug.success("FETCH_TEAM","Members processed",{projectId:e,members:l.map(e=>({id:e.id,email:e.email}))}),console.log("Processed team members:",l),eb(t=>({...t,[e]:l})),l}catch(e){return m.debug.error("FETCH_TEAM","Exception:",e),console.error("Error in fetchProjectTeamMembers:",e),[]}}async function te(e){let t=(0,P.createClient)();try{let{data:s,error:a}=await t.from("sub_projects").select("*, assigned_user:users!assigned_to(id, email, full_name, avatar_url, role)").eq("parent_project_id",e).order("created_at",{ascending:!1});if(a)return void console.warn("Sub-projects table not available:",a.message);eF(t=>({...t,[e]:s||[]}))}catch(e){console.error("Error fetching sub-projects:",e)}}async function tt(e){if(e.preventDefault(),!ec||en)return;ed(!0);let t=(0,P.createClient)();try{if(!eU.name.trim())throw Error("Task name is required");let e="unassigned"===eU.assigned_to?null:eU.assigned_to,{error:s}=await t.from("sub_projects").insert({parent_project_id:ec.id,name:eU.name,description:eU.description,assigned_to:e,due_date:eU.due_date||null,status:eU.status,video_url:eU.video_url||null,created_by:L?.id});if(s)throw s;if(e){let{error:s}=await t.from("employee_tasks").insert({user_id:e,project_id:ec.id,title:eU.name,description:eU.description,due_date:eU.due_date||null,status:"todo"});s&&console.warn("Warning: Task created in sub_projects but failed to create employee task:",s)}eq({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),eM(!1),await te(ec.id)}catch(t){console.error("Error adding sub-project:",t);let e=t?.message||t?.error_description||"Failed to add task";alert(e.includes("sub_projects")||e.includes("migration")?"Task feature not available. Please run migration 009 or contact support.":e)}finally{ed(!1)}}async function ts(e){if(e.preventDefault(),!eA||en)return;ed(!0);let t=(0,P.createClient)();try{let e="unassigned"===ez.assigned_to?null:ez.assigned_to,{error:s}=await t.from("sub_projects").update({name:ez.name,description:ez.description,assigned_to:e,due_date:ez.due_date||null,status:ez.status,video_url:ez.video_url||null}).eq("id",eA.id);if(s)throw s;if(e){let{data:s}=await t.from("employee_tasks").select("id").eq("user_id",e).eq("project_id",ec?.id).match({title:ez.name}).single();s||await t.from("employee_tasks").insert({user_id:e,project_id:ec?.id,title:ez.name,description:ez.description,due_date:ez.due_date||null,status:"todo"})}eR(!1),eB(null),ec&&await te(ec.id)}catch(e){console.error("Error updating sub-project:",e),alert("Failed to update task")}finally{ed(!1)}}async function ta(e,t){let s=(0,P.createClient)();try{let{error:a}=await s.from("sub_projects").update({progress_percentage:t}).eq("id",e);if(a)throw a;ec&&await te(ec.id)}catch(e){console.error("Error updating sub-project progress:",e)}}async function tl(e,t){let s=(0,P.createClient)();try{let{error:a}=await s.from("sub_projects").update({status:t,completed_at:"completed"===t?new Date().toISOString():null}).eq("id",e);if(a)throw a;ec&&await te(ec.id)}catch(e){console.error("Error updating sub-project status:",e)}}(0,s.useEffect)(()=>{let e=U.get("service");e&&["video_production","social_media","design_branding"].includes(e)&&el(e)},[U]),(0,s.useEffect)(()=>{e1()},[]),(0,s.useEffect)(()=>{eg&&ec&&(console.log("Team dialog opened, fetching members for project:",ec.id),e9(ec.id))},[eg,ec?.id]);let tr=q.filter(e=>{let t=e.name.toLowerCase().includes(Z.toLowerCase())||e.clients?.company_name.toLowerCase().includes(Z.toLowerCase()),s="all"===et||e.status===et,a="all"===ea||e.service_type===ea;return t&&s&&a}),ti={total:q.length,active:q.filter(e=>"in_progress"===e.status).length,completed:q.filter(e=>"completed"===e.status).length,planning:q.filter(e=>"planning"===e.status).length,totalBudget:q.reduce((e,t)=>e+(t.budget||0),0),avgProgress:q.length>0?Math.round(q.reduce((e,t)=>e+t.progress_percentage,0)/q.length):0};function tn(e){eo(e),eu(!0),te(e.id)}async function td(e){eo(e),ep(!0),await e9(e.id)}async function tc(e){if(e.preventDefault(),ec&&!en){ed(!0);try{let e=(0,P.createClient)(),{data:t,error:s}=await e.from("projects").update({name:eI.name,client_id:eI.client_id||null,description:eI.description||null,service_type:eI.service_type,budget:eI.budget?Number(eI.budget):null,start_date:eI.start_date||null,deadline:eI.deadline||null,status:eI.status,progress_percentage:eI.progress_percentage}).eq("id",ec.id).select().single();if(s)throw s;t&&z(e=>e.map(e=>e.id===ec.id?{...e,...t}:e)),ev(!1),await e1()}catch(e){console.error("Error updating project:",e),alert(e.message||"Failed to update project")}finally{ed(!1)}}}let to=e=>E.SERVICE_TYPES[e]?.icon||"ðŸ“",tm=e=>E.SERVICE_TYPES[e]?.label||e,[tu,th]=(0,s.useState)(!1),[tx,tg]=(0,s.useState)(!1),[tp,tj]=(0,s.useState)(null),[tv,tf]=(0,s.useState)([]);async function tb(t){let s=prompt("Title for content?")||"New Content",a=t.toISOString().slice(0,10);if(ec)try{let t=await (await e.A(90185)).createCalendarEvent({project_id:ec.id,event_date:a,title:s,status:"idea"});tf(e=>[...e,{id:t.id,date:t.event_date,title:t.title,copy:t.copy,status:t.status}])}catch(e){console.error(e),alert("Failed to create calendar event")}}async function tN(t){try{await (await e.A(90185)).updateCalendarEvent(t.id,{title:t.title,copy:t.copy,status:t.status,attachments:t.attachments?.map(e=>({url:e.url,kind:e.kind}))}),tf(e=>e.map(e=>e.id===t.id?t:e))}catch(e){console.error(e),alert("Failed to update event")}}async function t_(t){try{await (await e.A(90185)).deleteCalendarEvent(t),tf(e=>e.filter(e=>e.id!==t))}catch(e){console.error(e),alert("Failed to delete event")}}let tS=e=>{switch(e){case"video_production":return"default";case"social_media":default:return"secondary";case"design_branding":return"outline"}};return(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:L?.role==="project_manager"||L?.role==="employee"?"My Projects":"Projects"}),(0,t.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:L?.role==="project_manager"||L?.role==="employee"?"All your assigned projects and collaborations":"Manage all your video production projects"})]}),L?.role==="admin"&&(0,t.jsxs)(u.Dialog,{open:er,onOpenChange:ei,children:[(0,t.jsx)(u.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(r.Button,{className:"w-full md:w-auto",children:[(0,t.jsx)(x.Plus,{className:"mr-2 h-4 w-4"}),"New Project"]})}),(0,t.jsx)(u.DialogContent,{className:"max-w-md md:max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("form",{onSubmit:e3,children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Create New Project"}),(0,t.jsx)(u.DialogDescription,{children:"Enter the project details to get started."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"name",children:"Project Name *"}),(0,t.jsx)(i.Input,{id:"name",placeholder:"Brand Video Production",required:!0,value:e0.name,onChange:e=>e2({...e0,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"client",children:"Client *"}),(0,t.jsxs)(n.Select,{value:e0.client_id,onValueChange:e=>e2({...e0,client_id:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"client",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select a client"})}),(0,t.jsx)(n.SelectContent,{children:0===H.length?(0,t.jsx)(n.SelectItem,{value:"none",disabled:!0,children:"No clients available"}):H.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.company_name},e.id))})]}),0===H.length&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add a client first before creating a project"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"service",children:"Service Type *"}),(0,t.jsxs)(n.Select,{value:e0.service_type,onValueChange:e=>e2({...e0,service_type:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"service",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select service type"})}),(0,t.jsx)(n.SelectContent,{children:Object.values(E.SERVICE_TYPES).map(e=>(0,t.jsx)(n.SelectItem,{value:e.value,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{children:e.label})]})},e.value))})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:E.SERVICE_TYPES[e0.service_type].description})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"description",children:"Description"}),(0,t.jsx)(c.Textarea,{id:"description",placeholder:"Brief project description",value:e0.description,onChange:e=>e2({...e0,description:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"budget",children:"Budget (â‚¹)"}),(0,t.jsx)(i.Input,{id:"budget",type:"number",placeholder:"10000",value:e0.budget,onChange:e=>e2({...e0,budget:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"status",children:"Status"}),(0,t.jsxs)(n.Select,{value:e0.status,onValueChange:e=>e2({...e0,status:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"status",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"planning",children:"Planning"}),(0,t.jsx)(n.SelectItem,{value:"in_progress",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"in_review",children:"In Review"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"stuck",children:"Stuck"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"start_date",children:"Start Date"}),(0,t.jsx)(i.Input,{id:"start_date",type:"date",value:e0.start_date,onChange:e=>e2({...e0,start_date:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"deadline",children:"Deadline"}),(0,t.jsx)(i.Input,{id:"deadline",type:"date",value:e0.deadline,onChange:e=>e2({...e0,deadline:e.target.value})})]})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>ei(!1),disabled:en,children:"Cancel"}),(0,t.jsxs)(r.Button,{type:"submit",disabled:en||0===H.length,children:[en&&(0,t.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),en?"Creating...":"Create Project"]})]})]})})]})]}),!J&&q.length>0&&(0,t.jsxs)("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardDescription,{className:"text-xs",children:"Total Projects"}),(0,t.jsx)(l.CardTitle,{className:"text-2xl",children:ti.total})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[ti.active," active"]})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardDescription,{className:"text-xs",children:"Completed"}),(0,t.jsx)(l.CardTitle,{className:"text-2xl",children:ti.completed})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[q.length>0?Math.round(ti.completed/q.length*100):0,"% success rate"]})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardDescription,{className:"text-xs",children:"Total Budget"}),(0,t.jsxs)(l.CardTitle,{className:"text-2xl",children:["â‚¹",Math.round(ti.totalBudget/1e3),"k"]})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Across all projects"})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"pb-2",children:[(0,t.jsx)(l.CardDescription,{className:"text-xs",children:"Avg Progress"}),(0,t.jsxs)(l.CardTitle,{className:"text-2xl",children:[ti.avgProgress,"%"]})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)(o.Progress,{value:ti.avgProgress,className:"h-1"})})]})]}),(0,t.jsx)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-3",children:Object.values(E.SERVICE_TYPES).map(e=>{let s=q.filter(t=>t.service_type===e.value),a=ea===e.value;return(0,t.jsxs)(l.Card,{className:`cursor-pointer transition-all hover:shadow-lg ${a?"ring-2 ring-primary":""}`,onClick:()=>el(a?"all":e.value),children:[(0,t.jsx)(l.CardHeader,{className:`pb-3 bg-gradient-to-br ${e.color} text-white rounded-t-lg`,children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"text-3xl",children:e.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-lg text-white",children:e.label}),(0,t.jsx)(l.CardDescription,{className:"text-white/90 text-xs",children:e.description})]})]})})}),(0,t.jsx)(l.CardContent,{className:"pt-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:s.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Projects"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:[s.filter(e=>"completed"===e.status).length," Completed"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.filter(e=>"in_progress"===e.status).length," In Progress"]})]})]})})]},e.value)})}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(g.Search,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(i.Input,{placeholder:"Search projects...",className:"pl-8",value:Z,onChange:e=>ee(e.target.value)})]}),(0,t.jsxs)(n.Select,{value:ea,onValueChange:el,children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full md:w-[200px]",children:(0,t.jsx)(n.SelectValue,{placeholder:"Filter by service"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All Services"}),(0,t.jsx)(n.SelectItem,{value:"video_production",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[E.SERVICE_TYPES.video_production.icon," Video Production"]})}),(0,t.jsx)(n.SelectItem,{value:"social_media",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[E.SERVICE_TYPES.social_media.icon," Social Media"]})}),(0,t.jsx)(n.SelectItem,{value:"design_branding",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[E.SERVICE_TYPES.design_branding.icon," Design & Branding"]})})]})]}),(0,t.jsxs)(n.Select,{value:et,onValueChange:es,children:[(0,t.jsx)(n.SelectTrigger,{className:"w-full md:w-[180px]",children:(0,t.jsx)(n.SelectValue,{placeholder:"Filter by status"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"all",children:"All Status"}),(0,t.jsx)(n.SelectItem,{value:"planning",children:"Planning"}),(0,t.jsx)(n.SelectItem,{value:"in_progress",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"in_review",children:"In Review"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"stuck",children:"Stuck"}),(0,t.jsx)(n.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),J?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(v.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===q.length?(0,t.jsx)(l.Card,{children:(0,t.jsxs)(l.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(f.FolderKanban,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No projects yet"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Get started by creating your first project"}),(0,t.jsxs)(r.Button,{onClick:()=>ei(!0),disabled:0===H.length,children:[(0,t.jsx)(x.Plus,{className:"mr-2 h-4 w-4"}),"Create First Project"]}),0===H.length&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Add a client first in the Clients page"})]})}):(0,t.jsx)("div",{className:"grid gap-4",children:0===tr.length?(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"flex flex-col items-center justify-center py-12",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No projects match your search"})})}):tr.map(e=>(0,t.jsxs)(l.Card,{role:"button",tabIndex:0,onClick:()=>tn(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),tn(e))},className:"group relative overflow-hidden cursor-pointer rounded-2xl bg-white/10 dark:bg-white/5 border border-white/20 ring-1 ring-white/10 hover:ring-white/20 hover:bg-white/15 shadow-lg hover:shadow-xl transition-all duration-200 supports-[backdrop-filter]:backdrop-blur-lg hover:-translate-y-0.5",children:[(0,t.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/2 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent"}),(0,t.jsx)(l.CardHeader,{className:"relative z-10",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[e.thumbnail_url&&(0,t.jsx)("div",{className:"w-full md:w-32 h-32 rounded-lg overflow-hidden border bg-muted flex-shrink-0",children:(0,t.jsx)("img",{src:e.thumbnail_url,alt:e.name,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>tn(e),children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,t.jsx)(l.CardTitle,{children:e.name})}),(0,t.jsx)(l.CardDescription,{className:"mt-1",children:e.clients?.company_name||"No client"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(A.Badge,{variant:tS(e.service_type),children:[(0,t.jsx)("span",{className:"mr-1",children:to(e.service_type)}),tm(e.service_type)]}),(0,t.jsx)(h.StatusBadge,{status:e.status})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 text-sm",children:[e.created_by&&K[e.created_by]&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(k.UserCheck,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:K[e.created_by].full_name})]}),ef[e.id]&&ef[e.id].length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(w.Users,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,t.jsx)("div",{className:"flex gap-1 flex-wrap",children:ef[e.id].map(e=>(0,t.jsx)(A.Badge,{variant:"secondary",className:"text-xs",children:e.full_name||e.email.split("@")[0]},e.id))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(D.TrendingUp,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:[e.progress_percentage,"% complete"]})]})]})]})]})}),(0,t.jsxs)(l.CardContent,{className:"relative z-10 space-y-3",children:[e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.deadline&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,t.jsx)(p.Calendar,{className:"h-3 w-3"}),"Deadline"]}),(0,t.jsx)("p",{className:"font-medium",children:new Date(e.deadline).toLocaleDateString()})]}),e.budget&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,t.jsx)(j.DollarSign,{className:"h-3 w-3"}),"Budget"]}),(0,t.jsxs)("p",{className:"font-medium",children:["â‚¹",e.budget.toLocaleString()]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1",children:[(0,t.jsx)("span",{children:"Progress"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.progress_percentage,"%"]})]}),(0,t.jsx)(o.Progress,{value:e.progress_percentage,className:"h-1.5"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(r.Button,{variant:"secondary",size:"sm",onClick:t=>{t.stopPropagation(),tn(e)},children:[(0,t.jsx)(N.Eye,{className:"h-3 w-3 mr-1"}),"View"]}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),eo(e),eP({name:e.name,client_id:e.client_id,description:e.description||"",service_type:e.service_type,budget:e.budget?.toString()||"",start_date:e.start_date||"",deadline:e.deadline||"",status:e.status,progress_percentage:e.progress_percentage}),ev(!0)},children:[(0,t.jsx)(_,{className:"h-3 w-3 mr-1"}),"Edit"]}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),td(e)},children:[(0,t.jsx)(w.Users,{className:"h-3 w-3 mr-1"}),"Team"]}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),window.location.href=`/dashboard/invoices?project=${e.id}`},children:[(0,t.jsx)(C.FileText,{className:"h-3 w-3 mr-1"}),"Invoice"]})]})]})]},e.id))}),(0,t.jsx)(u.Dialog,{open:em,onOpenChange:eu,children:(0,t.jsxs)(u.DialogContent,{className:"max-w-4xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,t.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),ec&&(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsx)(u.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.DialogTitle,{className:"text-2xl",children:ec.name}),(0,t.jsxs)(u.DialogDescription,{className:"mt-2",children:["Client: ",ec.clients?.company_name||"No client"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(A.Badge,{variant:tS(ec.service_type),children:[(0,t.jsx)("span",{className:"mr-1",children:to(ec.service_type)}),tm(ec.service_type)]}),(0,t.jsx)(h.StatusBadge,{status:ec.status})]})]})}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:"Project Overview"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[ec.budget&&(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,t.jsx)(j.DollarSign,{className:"h-3 w-3"}),"Budget"]}),(0,t.jsxs)("p",{className:"font-semibold",children:["â‚¹",ec.budget.toLocaleString()]})]}),ec.start_date&&(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,t.jsx)(p.Calendar,{className:"h-3 w-3"}),"Start Date"]}),(0,t.jsx)("p",{className:"font-semibold",children:new Date(ec.start_date).toLocaleDateString()})]}),ec.deadline&&(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,t.jsx)(T.Clock,{className:"h-3 w-3"}),"Deadline"]}),(0,t.jsx)("p",{className:"font-semibold",children:new Date(ec.deadline).toLocaleDateString()})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,t.jsx)(D.TrendingUp,{className:"h-3 w-3"}),"Progress"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Progress,{value:ec.progress_percentage,className:"h-2 flex-1"}),(0,t.jsxs)("span",{className:"font-semibold text-sm",children:[ec.progress_percentage,"%"]})]})]})]})]}),ec.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Description"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:ec.description})]}),ec?.service_type==="social_media"&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,t.jsx)(r.Button,{size:"sm",variant:"default",onClick:()=>th(!0),children:"Content Calendar"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(I.ListTodo,{className:"h-4 w-4"}),"Sub-Projects / Tasks"]}),(0,t.jsxs)(r.Button,{size:"sm",variant:"outline",onClick:()=>eM(!0),children:[(0,t.jsx)(x.Plus,{className:"h-3 w-3 mr-1"}),"Add Task"]})]}),eE[ec.id]&&eE[ec.id].length>0?(0,t.jsx)("div",{className:"space-y-2",children:eE[ec.id].map(e=>(0,t.jsx)(l.Card,{className:"hover:border-primary/50 transition-colors",children:(0,t.jsx)(l.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.name}),(0,t.jsx)(h.StatusBadge,{status:e.status}),(0,t.jsx)(r.Button,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>{eB(e),eH({name:e.name,description:e.description||"",assigned_to:e.assigned_to||"unassigned",due_date:e.due_date||"",status:e.status,video_url:e.video_url||""}),eR(!0)},children:(0,t.jsx)(_,{className:"h-3 w-3"})})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),e.video_url&&(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsxs)("a",{href:e.video_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-primary hover:underline",children:[(0,t.jsx)(b.Video,{className:"h-3 w-3"}),"View Video"]})}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-muted-foreground",children:[e.assigned_user&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(k.UserCheck,{className:"h-3 w-3"}),e.assigned_user.full_name||e.assigned_user.email]}),e.due_date&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(p.Calendar,{className:"h-3 w-3"}),new Date(e.due_date).toLocaleDateString()]})]})]}),(0,t.jsxs)(n.Select,{value:e.status,onValueChange:t=>tl(e.id,t),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-[130px]",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"planning",children:"Planning"}),(0,t.jsx)(n.SelectItem,{value:"in_progress",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"in_review",children:"In Review"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"stuck",children:"Stuck"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Progress,{value:e.progress_percentage,className:"h-2 flex-1"}),(0,t.jsxs)("span",{className:"text-xs font-medium w-10 text-right",children:[e.progress_percentage,"%"]})]}),(0,t.jsx)(i.Input,{type:"range",min:"0",max:"100",value:e.progress_percentage,onChange:t=>ta(e.id,parseInt(t.target.value)),className:"h-2"})]})]})})},e.id))}):(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,t.jsx)(I.ListTodo,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No tasks yet. Break down this project into smaller tasks."]})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Milestones"}),(0,t.jsxs)(r.Button,{size:"sm",variant:"outline",onClick:()=>ex(!0),children:[(0,t.jsx)(x.Plus,{className:"h-3 w-3 mr-1"}),"Add Milestone"]})]}),$[ec.id]&&$[ec.id].length>0?(0,t.jsx)("div",{className:"space-y-2",children:$[ec.id].map(e=>(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.title}),(0,t.jsx)(h.StatusBadge,{status:e.status})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),e.due_date&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Due: ",new Date(e.due_date).toLocaleDateString()]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(n.Select,{value:e.status,onValueChange:t=>e8(ec.id,e.id,t),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-[160px]",children:(0,t.jsx)(n.SelectValue,{placeholder:"Status"})}),(0,t.jsx)(n.SelectContent,{children:ek.map(e=>(0,t.jsx)(n.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(r.Button,{variant:"ghost",size:"icon",onClick:()=>e5(ec.id,e.id),title:"Delete milestone",children:(0,t.jsx)(S.Trash2,{className:"h-4 w-4"})})]})]})})},e.id))}):(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,t.jsx)(y.CheckSquare,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No milestones yet. Add milestones to track project progress."]})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Team Members"}),L?.role==="admin"&&(0,t.jsxs)(r.Button,{size:"sm",variant:"outline",onClick:()=>ep(!0),children:[(0,t.jsx)(x.Plus,{className:"h-3 w-3 mr-1"}),"Assign Member"]})]}),ef[ec.id]&&ef[ec.id].length>0?(0,t.jsx)("div",{className:"space-y-2",children:ef[ec.id].map(e=>(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-sm font-medium",children:e.full_name?.charAt(0)||e.email.charAt(0)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.full_name||e.email}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.role})]})]}),L?.role==="admin"&&(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>e7(e.id),children:(0,t.jsx)(S.Trash2,{className:"h-4 w-4 text-destructive"})})]})})},e.id))}):(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,t.jsx)(w.Users,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No team members assigned yet."]})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:"Files & Documents"}),(0,t.jsx)(B.FileManager,{projectId:ec.id,driveFolderUrl:ec.drive_folder_url,onDriveFolderUpdate:e=>{eo({...ec,drive_folder_url:e}),z(t=>t.map(t=>t.id===ec.id?{...t,drive_folder_url:e}:t))}})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>eu(!1),children:"Close"}),(0,t.jsxs)(r.Button,{children:[(0,t.jsx)(_,{className:"h-4 w-4 mr-2"}),"Edit Project"]})]})]})]})}),(0,t.jsx)(u.Dialog,{open:tu&&ec?.service_type==="social_media",onOpenChange:th,children:(0,t.jsxs)(u.DialogContent,{className:"max-w-5xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,t.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),(0,t.jsxs)("div",{className:"relative z-10 space-y-4",children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{className:"text-2xl",children:"Content Calendar"}),(0,t.jsxs)(u.DialogDescription,{children:["Plan and manage content for ",ec?.name||"project"]})]}),(0,t.jsx)(function({events:e,onCreate:a,onUpdate:l,onDelete:i,onOpenDate:n}){let[d,c]=(0,s.useState)(new Date),o=new Date(d.getFullYear(),d.getMonth(),1),m=new Date(d.getFullYear(),d.getMonth()+1,0),u=o.getDay(),h=m.getDate(),x=[],g=Array(u).fill(null);for(let e=1;e<=h;e++){let t=new Date(d.getFullYear(),d.getMonth(),e);g.push(t),7===g.length&&(x.push(g),g=[])}if(g.length){for(;g.length<7;)g.push(null);x.push(g)}let p=new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric"});function j(t){let s=t.toISOString().slice(0,10);return e.filter(e=>(e.date||"").slice(0,10)===s)}return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-xl font-semibold",children:p.format(d)}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:()=>c(new Date(d.getFullYear(),d.getMonth()-1,1)),children:"Prev"}),(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:()=>c(new Date),children:"Today"}),(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:()=>c(new Date(d.getFullYear(),d.getMonth()+1,1)),children:"Next"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-7 gap-2 text-xs text-muted-foreground",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,t.jsx)("div",{className:"px-2 py-1",children:e},e))}),(0,t.jsx)("div",{className:"grid grid-cols-7 gap-2",children:x.map((e,s)=>(0,t.jsx)("div",{className:"contents",children:e.map((e,s)=>(0,t.jsx)("div",{className:"rounded-lg border p-2 min-h-[110px] bg-white/5 hover:bg-white/10 transition-colors",children:e?(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-xs font-medium",children:e.getDate()}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>a(e),children:"+ Add"}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>n(e,j(e)),children:"Open"})]})]}),(0,t.jsx)("div",{className:"space-y-2",children:j(e).map(e=>(0,t.jsxs)("div",{className:"rounded-md border p-2 bg-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"text-xs font-medium truncate",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>i(e.id),children:"Del"}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>l({...e,status:"published"===e.status?"scheduled":"published"}),children:"published"===e.status?"Unpublish":"Publish"}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>{let t=prompt("Paste image/video URL");if(!t)return;let s=t.match(/\.(png|jpg|jpeg|gif|webp)$/i)?"image":t.match(/\.(mp4|webm|mov)$/i)?"video":t.match(/\.(pdf)$/i)?"pdf":"document",a={id:Math.random().toString(36).slice(2),url:t,kind:s};l({...e,attachments:[...e.attachments||[],a]})},children:"Add Media"})]})]}),e.copy&&(0,t.jsx)("div",{className:"mt-1 text-[11px] text-muted-foreground line-clamp-3 whitespace-pre-wrap",children:e.copy}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.platform&&(0,t.jsx)(A.Badge,{variant:"outline",className:"text-[10px]",children:e.platform}),e.type&&(0,t.jsx)(A.Badge,{variant:"outline",className:"text-[10px]",children:e.type}),e.status&&(0,t.jsx)(A.Badge,{variant:"outline",className:"text-[10px]",children:e.status})]}),e.attachments&&e.attachments.length>0&&(0,t.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:e.attachments.map(e=>(0,t.jsxs)("div",{className:"rounded-md overflow-hidden border bg-black/20",children:["image"===e.kind&&(0,t.jsx)("img",{src:e.url,alt:"attachment",className:"w-full h-20 object-cover"}),"video"===e.kind&&(0,t.jsx)("video",{src:e.url,className:"w-full h-20 object-cover",controls:!0,preload:"metadata"}),"image"!==e.kind&&"video"!==e.kind&&(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs p-2 inline-block w-full truncate",children:e.url})]},e.id))})]},e.id))})]}):null},s))},s))})]})},{events:tv,onCreate:e=>tb(e),onUpdate:e=>tN(e),onDelete:e=>t_(e),onOpenDate:(e,t)=>{tj({date:e,events:t}),tg(!0)}})]})]})}),(0,t.jsx)(u.Dialog,{open:tx,onOpenChange:tg,children:(0,t.jsxs)(u.DialogContent,{className:"max-w-3xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,t.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),(0,t.jsxs)("div",{className:"relative z-10 space-y-4",children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{className:"text-2xl",children:tp?new Date(tp.date).toLocaleDateString():"Date"}),(0,t.jsx)(u.DialogDescription,{children:"Detailed content planning"})]}),(0,t.jsx)(function({onAdd:a}){let[d,o]=(0,s.useState)(""),[m,u]=(0,s.useState)(""),[h,x]=(0,s.useState)("instagram"),[g,p]=(0,s.useState)("reel"),[j,v]=(0,s.useState)("idea"),[f,b]=(0,s.useState)(""),[N,_]=(0,s.useState)(!1),[S,w]=(0,s.useState)([]);async function C(t){let s=t.target.files?.[0];if(s){_(!0);try{let{validateFileSize:t,getFileType:a}=await e.A(86712),l=t(s);if(!l.valid)return void alert(l.error);let r=a(s.name),{createClient:i}=await e.A(90015),n=i(),d=`content/${Date.now()}_${s.name}`,{error:c}=await n.storage.from("project-files").upload(d,s,{cacheControl:"3600",upsert:!1});if(c)throw Error(c.message);let{data:o}=n.storage.from("project-files").getPublicUrl(d),m={id:Math.random().toString(36).slice(2),url:o.publicUrl,kind:"other"===r?"document":r};w(e=>[...e||[],m])}catch(e){console.error("Upload failed",e),alert(e.message||"Upload failed")}finally{_(!1),t.target.value=""}}}return(0,t.jsx)(l.Card,{children:(0,t.jsxs)(l.CardContent,{className:"p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Title"}),(0,t.jsx)(i.Input,{value:d,onChange:e=>o(e.target.value),placeholder:"Content title"})]}),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Copy / Caption"}),(0,t.jsx)(c.Textarea,{value:m,onChange:e=>u(e.target.value),placeholder:"Write caption, brief, or notes",rows:4})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Platform"}),(0,t.jsxs)(n.Select,{value:h,onValueChange:e=>x(e),children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"instagram",children:"Instagram"}),(0,t.jsx)(n.SelectItem,{value:"facebook",children:"Facebook"}),(0,t.jsx)(n.SelectItem,{value:"youtube",children:"YouTube"}),(0,t.jsx)(n.SelectItem,{value:"linkedin",children:"LinkedIn"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Type"}),(0,t.jsxs)(n.Select,{value:g,onValueChange:e=>p(e),children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"reel",children:"Reel"}),(0,t.jsx)(n.SelectItem,{value:"carousel",children:"Carousel"}),(0,t.jsx)(n.SelectItem,{value:"story",children:"Story"}),(0,t.jsx)(n.SelectItem,{value:"static",children:"Static"}),(0,t.jsx)(n.SelectItem,{value:"video",children:"Video"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Status"}),(0,t.jsxs)(n.Select,{value:j,onValueChange:e=>v(e),children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"idea",children:"Idea"}),(0,t.jsx)(n.SelectItem,{value:"editing",children:"Editing"}),(0,t.jsx)(n.SelectItem,{value:"review",children:"Ready for review"}),(0,t.jsx)(n.SelectItem,{value:"scheduled",children:"Scheduled"}),(0,t.jsx)(n.SelectItem,{value:"published",children:"Published"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Attachment URL (optional)"}),(0,t.jsx)(i.Input,{value:f,onChange:e=>b(e.target.value),placeholder:"https://..."}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"file",onChange:C,accept:"image/*,video/*,.pdf,.doc,.docx,.txt"}),N&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Uploadingâ€¦"})]}),S&&S.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:S.map(e=>(0,t.jsxs)("div",{className:"rounded-md overflow-hidden border bg-black/20",children:["image"===e.kind&&(0,t.jsx)("img",{src:e.url,alt:"attachment",className:"w-full h-20 object-cover"}),"video"===e.kind&&(0,t.jsx)("video",{src:e.url,className:"w-full h-20 object-cover",controls:!0,preload:"metadata"}),"image"!==e.kind&&"video"!==e.kind&&(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs p-2 inline-block w-full truncate",children:e.url})]},e.id))})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(r.Button,{onClick:()=>{d.trim()&&(a({title:d,copy:m,platform:h,type:g,status:j,attachments:[...S||[],...function(e){if(!e)return;let t=e.match(/\.(png|jpg|jpeg|gif|webp)$/i)?"image":e.match(/\.(mp4|webm|mov)$/i)?"video":e.match(/\.(pdf)$/i)?"pdf":"document";return[{id:Math.random().toString(36).slice(2),url:e,kind:t}]}(f)||[]]}),o(""),u(""),b(""),w([]))},children:"Add to Calendar"})})]})})},{onAdd:e=>{let t=tp?.date||new Date,s={id:Math.random().toString(36).slice(2),date:new Date(t.getFullYear(),t.getMonth(),t.getDate()).toISOString(),title:e.title,platform:e.platform,type:e.type,status:e.status,attachments:e.attachments||[]};tf(e=>[...e,s])}}),(0,t.jsx)("div",{className:"space-y-3",children:0===(tp?.events||[]).length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No content entries for this day"}):(tp?.events||[]).map(e=>(0,t.jsxs)("div",{className:"rounded-md border p-3 bg-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.title}),e.platform&&(0,t.jsx)(A.Badge,{variant:"outline",className:"text-[10px]",children:e.platform}),e.type&&(0,t.jsx)(A.Badge,{variant:"outline",className:"text-[10px]",children:e.type}),e.status&&(0,t.jsx)(A.Badge,{variant:"outline",className:"text-[10px]",children:e.status})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>t_(e.id),children:"Delete"}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>tN({...e,status:"published"===e.status?"scheduled":"published"}),children:"published"===e.status?"Unpublish":"Publish"})]})]}),e.copy&&(0,t.jsx)("div",{className:"mt-2 text-sm text-muted-foreground whitespace-pre-wrap",children:e.copy}),e.attachments&&e.attachments.length>0&&(0,t.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:e.attachments.map(e=>(0,t.jsxs)("div",{className:"rounded-md overflow-hidden border bg-black/20",children:["image"===e.kind&&(0,t.jsx)("img",{src:e.url,alt:"attachment",className:"w-full h-24 object-cover"}),"video"===e.kind&&(0,t.jsx)("video",{src:e.url,className:"w-full h-24 object-cover",controls:!0,preload:"metadata"}),"image"!==e.kind&&"video"!==e.kind&&(0,t.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs p-2 inline-block w-full truncate",children:e.url})]},e.id))})]},e.id))})]})]})}),(0,t.jsx)(u.Dialog,{open:eh,onOpenChange:ex,children:(0,t.jsx)(u.DialogContent,{children:(0,t.jsxs)("form",{onSubmit:e4,children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Add Milestone"}),(0,t.jsxs)(u.DialogDescription,{children:["Create a new milestone for ",ec?.name]})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"milestone-title",children:"Title *"}),(0,t.jsx)(i.Input,{id:"milestone-title",placeholder:"Script completion",required:!0,value:eD.title,onChange:e=>eT({...eD,title:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"milestone-desc",children:"Description"}),(0,t.jsx)(c.Textarea,{id:"milestone-desc",placeholder:"Complete final draft of script",value:eD.description,onChange:e=>eT({...eD,description:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"milestone-date",children:"Due Date"}),(0,t.jsx)(i.Input,{id:"milestone-date",type:"date",value:eD.due_date,onChange:e=>eT({...eD,due_date:e.target.value})})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>ex(!1),disabled:en,children:"Cancel"}),(0,t.jsxs)(r.Button,{type:"submit",disabled:en,children:[en&&(0,t.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Milestone"]})]})]})})}),L?.role==="admin"&&(0,t.jsx)(u.Dialog,{open:eg,onOpenChange:ep,children:(0,t.jsxs)(u.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(u.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.DialogTitle,{children:"Team Members"}),(0,t.jsxs)(u.DialogDescription,{children:["Manage team members for ",ec?.name]})]}),(0,t.jsxs)(r.Button,{variant:"outline",size:"sm",onClick:()=>ec&&e9(ec.id),className:"gap-2",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),(0,t.jsx)("path",{d:"M21 3v5h-5"})]}),"Refresh"]})]})}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[!1,ef[ec?.id||""]&&ef[ec?.id||""].length>0&&(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 p-4 bg-muted/50 rounded-lg",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:ef[ec?.id||""].length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Team Members"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:ef[ec?.id||""].filter(e=>"admin"===e.role).length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Admins"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:ef[ec?.id||""].filter(e=>"project_manager"===e.role).length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"PMs"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold mb-3",children:["Current Team Members (",ef[ec?.id||""]?.length||0,")"]}),ef[ec?.id||""]&&ef[ec?.id||""].length>0?(0,t.jsx)("div",{className:"space-y-2",children:ef[ec?.id||""].map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:border-primary/50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("span",{className:"text-sm font-semibold text-primary",children:e.full_name?.charAt(0)||e.email.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-medium truncate",children:e.full_name||e.email}),(0,t.jsx)(A.Badge,{variant:"admin"===e.role?"default":"secondary",className:"text-[10px] px-1.5 py-0",children:"admin"===e.role?"Admin":"PM"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.email})]})]}),(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>e7(e.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:(0,t.jsx)(S.Trash2,{className:"h-4 w-4"})})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm border rounded-lg",children:[(0,t.jsx)(w.Users,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No team members assigned yet"]})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:"Add Team Member"}),(0,t.jsxs)("form",{onSubmit:e6,children:[(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"team-member",children:"Team Member *"}),(0,t.jsxs)(n.Select,{value:eS,onValueChange:ew,required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"team-member",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select a team member"})}),(0,t.jsx)(n.SelectContent,{children:0===eN.length?(0,t.jsx)(n.SelectItem,{value:"none",disabled:!0,children:"No users available"}):eN.filter(e=>!ef[ec?.id||""]?.find(t=>t.id===e.id)).map(e=>(0,t.jsxs)(n.SelectItem,{value:e.id,children:[e.full_name," (",e.email,")"]},e.id))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"team-role",children:"Role (Optional)"}),(0,t.jsx)(i.Input,{id:"team-role",placeholder:"e.g., Lead Editor, Designer",value:eC,onChange:e=>ey(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>ep(!1),disabled:en,children:"Close"}),(0,t.jsxs)(r.Button,{type:"submit",disabled:en||!eS,children:[en&&(0,t.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Assign Member"]})]})]})]})]})]})}),(0,t.jsx)(u.Dialog,{open:ej,onOpenChange:ev,children:(0,t.jsx)(u.DialogContent,{className:"max-w-md md:max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("form",{onSubmit:tc,children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Edit Project"}),(0,t.jsx)(u.DialogDescription,{children:"Update project details"})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-name",children:"Project Name *"}),(0,t.jsx)(i.Input,{id:"edit-name",required:!0,value:eI.name,onChange:e=>eP({...eI,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-client",children:"Client *"}),(0,t.jsxs)(n.Select,{value:eI.client_id,onValueChange:e=>eP({...eI,client_id:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"edit-client",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select a client"})}),(0,t.jsx)(n.SelectContent,{children:H.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.company_name},e.id))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-description",children:"Description"}),(0,t.jsx)(c.Textarea,{id:"edit-description",placeholder:"Project description",value:eI.description,onChange:e=>eP({...eI,description:e.target.value}),rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-service",children:"Service Type *"}),(0,t.jsxs)(n.Select,{value:eI.service_type,onValueChange:e=>eP({...eI,service_type:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"edit-service",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsx)(n.SelectContent,{children:E.SERVICE_TYPE_OPTIONS.map(e=>(0,t.jsxs)(n.SelectItem,{value:e.value,children:[(0,t.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.value))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-status",children:"Status *"}),(0,t.jsxs)(n.Select,{value:eI.status,onValueChange:e=>eP({...eI,status:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"edit-status",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"planning",children:"Planning"}),(0,t.jsx)(n.SelectItem,{value:"in_progress",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"in_review",children:"In Review"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"stuck",children:"Stuck"}),(0,t.jsx)(n.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-budget",children:"Budget (â‚¹)"}),(0,t.jsx)(i.Input,{id:"edit-budget",type:"number",placeholder:"100000",value:eI.budget,onChange:e=>eP({...eI,budget:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-progress",children:"Progress (%)"}),(0,t.jsx)(i.Input,{id:"edit-progress",type:"number",min:"0",max:"100",value:eI.progress_percentage,onChange:e=>eP({...eI,progress_percentage:parseInt(e.target.value)||0})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-start",children:"Start Date"}),(0,t.jsx)(i.Input,{id:"edit-start",type:"date",value:eI.start_date,onChange:e=>eP({...eI,start_date:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-deadline",children:"Deadline"}),(0,t.jsx)(i.Input,{id:"edit-deadline",type:"date",value:eI.deadline,onChange:e=>eP({...eI,deadline:e.target.value})})]})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>ev(!1),disabled:en,children:"Cancel"}),(0,t.jsxs)(r.Button,{type:"submit",disabled:en,children:[en&&(0,t.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})})}),(0,t.jsx)(u.Dialog,{open:eL,onOpenChange:e=>{e||eq({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),eM(e)},children:(0,t.jsx)(u.DialogContent,{children:(0,t.jsxs)("form",{onSubmit:tt,children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Add Sub-Project / Task"}),(0,t.jsxs)(u.DialogDescription,{children:["Create a task for ",ec?.name]})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"sub-project-name",children:"Task Name *"}),(0,t.jsx)(i.Input,{id:"sub-project-name",placeholder:"e.g., Script Writing, Video Editing",required:!0,value:eU.name,onChange:e=>eq({...eU,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"sub-project-desc",children:"Description"}),(0,t.jsx)(c.Textarea,{id:"sub-project-desc",placeholder:"Task details...",value:eU.description,onChange:e=>eq({...eU,description:e.target.value}),rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"sub-project-assign",children:"Assign To"}),(0,t.jsxs)(n.Select,{value:eU.assigned_to,onValueChange:e=>eq({...eU,assigned_to:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"sub-project-assign",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select team member"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"unassigned",children:"Unassigned"}),eN.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.full_name||e.email},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"sub-project-status",children:"Status"}),(0,t.jsxs)(n.Select,{value:eU.status,onValueChange:e=>eq({...eU,status:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"sub-project-status",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"planning",children:"Planning"}),(0,t.jsx)(n.SelectItem,{value:"in_progress",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"in_review",children:"In Review"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"stuck",children:"Stuck"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"sub-project-date",children:"Due Date"}),(0,t.jsx)(i.Input,{id:"sub-project-date",type:"date",value:eU.due_date,onChange:e=>eq({...eU,due_date:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"sub-project-video",children:"Video URL (Optional)"}),(0,t.jsx)(i.Input,{id:"sub-project-video",type:"url",placeholder:"https://youtube.com/watch?v=... or https://drive.google.com/...",value:eU.video_url,onChange:e=>eq({...eU,video_url:e.target.value})}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add a YouTube, Google Drive, or other video link"})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>eM(!1),disabled:en,children:"Cancel"}),(0,t.jsxs)(r.Button,{type:"submit",disabled:en||!eU.name.trim(),children:[en&&(0,t.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),en?"Creating Task...":"Add Task"]})]})]})})}),(0,t.jsx)(u.Dialog,{open:eV,onOpenChange:eR,children:(0,t.jsx)(u.DialogContent,{className:"max-w-2xl",children:(0,t.jsxs)("form",{onSubmit:ts,children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Edit Task"}),(0,t.jsx)(u.DialogDescription,{children:"Update task details for this project"})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-sub-project-name",children:"Task Name *"}),(0,t.jsx)(i.Input,{id:"edit-sub-project-name",value:ez.name,onChange:e=>eH({...ez,name:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-sub-project-description",children:"Description"}),(0,t.jsx)(c.Textarea,{id:"edit-sub-project-description",value:ez.description,onChange:e=>eH({...ez,description:e.target.value}),rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-sub-project-assigned",children:"Assigned To"}),(0,t.jsxs)(n.Select,{value:ez.assigned_to,onValueChange:e=>eH({...ez,assigned_to:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"edit-sub-project-assigned",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"unassigned",children:"Unassigned"}),eN.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.full_name||e.email},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-sub-project-status",children:"Status"}),(0,t.jsxs)(n.Select,{value:ez.status,onValueChange:e=>eH({...ez,status:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"edit-sub-project-status",children:(0,t.jsx)(n.SelectValue,{})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"planning",children:"Planning"}),(0,t.jsx)(n.SelectItem,{value:"in_progress",children:"In Progress"}),(0,t.jsx)(n.SelectItem,{value:"in_review",children:"In Review"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"stuck",children:"Stuck"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-sub-project-date",children:"Due Date"}),(0,t.jsx)(i.Input,{id:"edit-sub-project-date",type:"date",value:ez.due_date,onChange:e=>eH({...ez,due_date:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.Label,{htmlFor:"edit-sub-project-video",children:"Video URL (Optional)"}),(0,t.jsx)(i.Input,{id:"edit-sub-project-video",type:"url",placeholder:"https://youtube.com/watch?v=... or https://drive.google.com/...",value:ez.video_url,onChange:e=>eH({...ez,video_url:e.target.value})}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add a YouTube, Google Drive, or other video link"})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>{eR(!1),eB(null)},disabled:en,children:"Cancel"}),(0,t.jsxs)(r.Button,{type:"submit",disabled:en,children:[en&&(0,t.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Task"]})]})]})})})]})}function q(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(v.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,t.jsx)(U,{})})}e.s(["default",()=>q],88289)}]);