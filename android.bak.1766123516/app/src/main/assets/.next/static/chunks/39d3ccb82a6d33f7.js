(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94179,e=>{"use strict";var t=e.i(43476),s=e.i(25913),a=e.i(47163);let r=(0,s.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600"}},defaultVariants:{variant:"default"}});function i({className:e,variant:s,...i}){return(0,t.jsx)("div",{className:(0,a.cn)(r({variant:s}),e),...i})}e.s(["Badge",()=>i])},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},86536,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},78892,e=>{"use strict";var t=e.i(43476),s=e.i(94179);function a({status:e}){return(0,t.jsx)(s.Badge,{variant:(e=>{switch(e){case"completed":case"done":case"paid":case"active":return"success";case"in_progress":case"in_review":case"sent":return"info";case"planning":case"pending":case"draft":return"warning";case"stuck":case"blocked":case"cancelled":case"overdue":case"inactive":return"destructive";default:return"default"}})(e),children:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})}e.s(["StatusBadge",()=>a])},81518,e=>{"use strict";var t=e.i(43476),s=e.i(70065),a=e.i(25652);let r=(0,e.i(75254).default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);var i=e.i(47163);function l({title:e,value:l,change:n,trend:c="neutral",icon:d,iconClassName:o}){return(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:e}),d&&(0,t.jsx)(d,{className:(0,i.cn)("h-4 w-4 text-muted-foreground",o)})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:l}),n&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:["up"===c&&(0,t.jsx)(a.TrendingUp,{className:"h-3 w-3 text-green-500"}),"down"===c&&(0,t.jsx)(r,{className:"h-3 w-3 text-red-500"}),(0,t.jsx)("span",{className:(0,i.cn)("up"===c&&"text-green-500","down"===c&&"text-red-500","neutral"===c&&"text-muted-foreground"),children:n}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"from last period"})]})]})]})}e.s(["StatCard",()=>l],81518)},59208,e=>{"use strict";let t=(0,e.i(75254).default)("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);e.s(["CalendarClock",()=>t],59208)},23656,e=>{"use strict";var t=e.i(43476),s=e.i(61668),a=e.i(71645),r=e.i(18566),i=e.i(81518),l=e.i(70065),n=e.i(67881),c=e.i(67236),d=e.i(40160),o=e.i(78583),u=e.i(7233),m=e.i(86536);let x=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var h=e.i(59208),p=e.i(62870),g=e.i(78892),f=e.i(20755);function j(){let{user:e,loading:j}=(0,s.useAuth)(),v=(0,r.useRouter)(),[N,w]=(0,a.useState)([]),[y,b]=(0,a.useState)([]),[C,k]=(0,a.useState)([]),[S,_]=(0,a.useState)(null),[P,T]=(0,a.useState)(!0),[D,A]=(0,a.useState)("all"),[B,M]=(0,a.useState)("all"),[L,q]=(0,a.useState)({activeProjects:0,completedProjects:0,pendingInvoices:0,totalSpent:0}),I=(0,a.useMemo)(()=>"all"===D?N:N.filter(e=>e.status===D),[N,D]),$=(0,a.useMemo)(()=>"all"===B?y:y.filter(e=>e.status===B),[y,B]),F=(0,a.useMemo)(()=>[...y].filter(e=>"paid"!==e.status&&e.due_date).sort((e,t)=>new Date(e.due_date).getTime()-new Date(t.due_date).getTime())[0],[y]),z=(0,a.useMemo)(()=>[...C].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())[0],[C]);if((0,a.useEffect)(()=>{!async function(){if(!e||j)return;let t=(0,f.createClient)();try{let{data:s,error:a}=await t.from("clients").select("*").eq("user_id",e.id).single();if(a)throw a;_(s);let{data:r,error:i}=await t.from("projects").select("*").eq("client_id",s.id).order("created_at",{ascending:!1});if(i)throw i;let{data:l,error:n}=await t.from("invoices").select("*").eq("client_id",s.id).order("created_at",{ascending:!1});if(n)throw n;let c=r?.map(e=>e.id)||[],{data:d,error:o}=await t.from("project_files").select("*, projects(name)").in("project_id",c).order("created_at",{ascending:!1}).limit(5);if(o)throw o;w(r||[]),b(l||[]),k(d||[]);let u=r?.filter(e=>"in_progress"===e.status||"in_review"===e.status)?.length||0,m=r?.filter(e=>"completed"===e.status)?.length||0,x=l?.filter(e=>"sent"===e.status||"overdue"===e.status)?.length||0,h=l?.filter(e=>"paid"===e.status)?.reduce((e,t)=>e+(t.total||0),0)||0;q({activeProjects:u,completedProjects:m,pendingInvoices:x,totalSpent:h})}catch(e){console.error("Error fetching client data:",e)}finally{T(!1)}}()},[e?.id,j]),j||P)return(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})});let R=[{title:"Active Projects",value:L.activeProjects.toString(),change:`${L.completedProjects} completed`,trend:"neutral",icon:c.FolderKanban},{title:"Total Spent",value:`₹${L.totalSpent.toLocaleString()}`,change:"Paid invoices",trend:"neutral",icon:o.FileText},{title:"Pending Invoices",value:L.pendingInvoices.toString(),change:"Awaiting payment",trend:L.pendingInvoices>0?"down":"neutral",icon:o.FileText},{title:"Latest Files",value:C.length.toString(),change:"Available downloads",trend:"up",icon:d.Download},{title:"Next Due Invoice",value:F?`₹${(F.total||0).toLocaleString()}`:"None",change:F?`Due ${new Date(F.due_date).toLocaleDateString()}`:"All paid",trend:F?"down":"up",icon:h.CalendarClock},{title:"Last Delivery",value:z?z.file_name||"File":"No files",change:z?`From ${z.projects?.name||"Project"}`:"Waiting for first upload",trend:z?"up":"neutral",icon:d.Download}];return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:["Welcome, ",S?.company_name]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Track your projects and download deliverables"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>A("all"===D?"in_progress":"all"),children:[(0,t.jsx)(x,{className:"h-4 w-4 mr-2"}),"all"===D?"Show Active":"Show All"]}),(0,t.jsxs)(n.Button,{onClick:()=>v.push("/dashboard/client/request"),children:[(0,t.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Request Project"]})]})]}),(0,t.jsx)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:R.map(e=>(0,t.jsx)(i.StatCard,{...e},e.title))}),(0,t.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-lg md:text-xl",children:"Your Projects"}),(0,t.jsx)(l.CardDescription,{className:"text-xs md:text-sm",children:"Track progress and view updates"})]})}),(0,t.jsx)(l.CardContent,{children:0===I.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"No projects match this filter"}),(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>A("all"),children:"Reset Filter"})]}):(0,t.jsx)("div",{className:"space-y-4",children:I.slice(0,3).map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>v.push(`/dashboard/client/projects/${e.id}`),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:e.description})]}),(0,t.jsx)(g.StatusBadge,{status:e.status})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,t.jsx)("div",{className:"h-2 flex-1 bg-secondary rounded-full overflow-hidden max-w-[200px]",children:(0,t.jsx)("div",{className:"h-full bg-primary transition-all",style:{width:`${e.progress_percentage}%`}})}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.progress_percentage,"%"]})]}),(0,t.jsxs)(n.Button,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),v.push(`/dashboard/client/projects/${e.id}`)},children:[(0,t.jsx)(m.Eye,{className:"h-4 w-4 mr-1"}),"View"]})]})]},e.id))})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-lg md:text-xl",children:"Latest Deliverables"}),(0,t.jsx)(l.CardDescription,{className:"text-xs md:text-sm",children:"Recent files from your projects"})]})}),(0,t.jsx)(l.CardContent,{children:0===C.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No files yet"}):(0,t.jsx)("div",{className:"space-y-3",children:C.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,t.jsx)(o.FileText,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-sm truncate",children:e.file_name}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.projects?.name})]})]}),(0,t.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>{v.push(`/dashboard/client/projects/${e.project_id}`)},children:(0,t.jsx)(m.Eye,{className:"h-4 w-4"})})]},e.id))})})]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.CardTitle,{className:"text-lg md:text-xl",children:"Invoices"}),(0,t.jsx)(l.CardDescription,{className:"text-xs md:text-sm",children:"View and pay your invoices"})]}),(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>v.push("/dashboard/client/invoices"),children:"View All"})]}),(0,t.jsxs)(l.CardContent,{children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,t.jsxs)(p.Select,{value:B,onValueChange:M,children:[(0,t.jsx)(p.SelectTrigger,{className:"w-[170px]",children:(0,t.jsx)(p.SelectValue,{placeholder:"All invoices"})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"all",children:"All"}),(0,t.jsx)(p.SelectItem,{value:"paid",children:"Paid"}),(0,t.jsx)(p.SelectItem,{value:"sent",children:"Sent"}),(0,t.jsx)(p.SelectItem,{value:"overdue",children:"Overdue"})]})]})}),0===$.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No invoices match this filter"}):(0,t.jsx)("div",{className:"space-y-3",children:$.slice(0,5).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>v.push(`/dashboard/client/invoices/${e.id}`),children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:e.invoice_number}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Due: ",new Date(e.due_date).toLocaleDateString()]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-medium",children:["₹",e.total?.toLocaleString()]}),(0,t.jsx)(g.StatusBadge,{status:e.status})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[(0,t.jsxs)(n.Button,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),e.invoice_url&&window.open(e.invoice_url,"_blank")},children:[(0,t.jsx)(d.Download,{className:"h-4 w-4 mr-1"})," PDF"]}),"paid"!==e.status&&(0,t.jsx)(n.Button,{size:"sm",onClick:t=>{t.stopPropagation(),v.push(`/dashboard/client/invoices/${e.id}/pay`)},children:"Pay Now"})]})]},e.id))})]})]}),N.length>0&&(0,t.jsx)(l.Card,{className:"bg-primary/5 border-primary/20",children:(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg",children:"Need Another Project?"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Submit a request and our team will get back to you"})]}),(0,t.jsxs)(n.Button,{onClick:()=>v.push("/dashboard/client/request"),children:[(0,t.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"New Request"]})]})})})]})}function v(){let{loading:e}=(0,s.useAuth)();return e?(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})}):(0,t.jsx)(j,{})}e.s(["default",()=>v],23656)}]);