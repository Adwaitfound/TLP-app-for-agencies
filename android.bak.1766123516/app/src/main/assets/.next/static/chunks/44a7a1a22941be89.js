(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78928,e=>{"use strict";var s=e.i(43476),t=e.i(61668),a=e.i(18566),r=e.i(71645),l=e.i(81518),i=e.i(70065),n=e.i(67881),d=e.i(30374),c=e.i(87336),o=e.i(12426),m=e.i(67236),x=e.i(78583),u=e.i(7233),h=e.i(87316),p=e.i(61911),g=e.i(25652),j=e.i(63209),f=e.i(95468);let v=(0,e.i(75254).default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var N=e.i(45423),b=e.i(3116),C=e.i(78892),w=e.i(20755),y=e.i(94179),_=e.i(27341),S=e.i(62870),D=e.i(23750),k=e.i(73297),T=e.i(95187),B=(0,T.createServerReference)("40e9debad081e2ea61fef36767d769afdc486d2864",T.callServer,void 0,T.findSourceMapURL,"reviewProjectProposal"),P=(0,T.createServerReference)("407d00f69ec1463aaf4cba7dfeb078331c034b7beb",T.callServer,void 0,T.findSourceMapURL,"approveUserAccount"),A=(0,T.createServerReference)("40562833b8610881280abfc4553d749f1e50b42e3d",T.callServer,void 0,T.findSourceMapURL,"grantAdminByEmail"),L=e.i(15562);function I(){let e,T,I,F,R,M,E,U,V,H,z,{user:Y,loading:$}=(0,t.useAuth)(),q=(0,a.useRouter)(),[O,G]=(0,r.useState)([]),[K,Q]=(0,r.useState)([]),[W,J]=(0,r.useState)([]),[Z,X]=(0,r.useState)([]),[ee,es]=(0,r.useState)([]),[et,ea]=(0,r.useState)({}),[er,el]=(0,r.useState)(!1),[ei,en]=(0,r.useState)(!1),[ed,ec]=(0,r.useState)(!0),[eo,em]=(0,r.useState)(null),[ex,eu]=(0,r.useState)("all"),[eh,ep]=(0,r.useState)(null),[eg,ej]=(0,r.useState)([]),[ef,ev]=(0,r.useState)(!1),[eN,eb]=(0,r.useState)(null),[eC,ew]=(0,r.useState)(!1),[ey,e_]=(0,r.useState)(""),[eS,eD]=(0,r.useState)(!1),[ek,eT]=(0,r.useState)(""),[eB,eP]=(0,r.useState)(!1),[eA,eL]=(0,r.useState)(""),[eI,eF]=(0,r.useState)(!1),[eR,eM]=(0,r.useState)({totalRevenue:0,activeProjects:0,pendingInvoices:0,totalClients:0,overdueInvoices:0,completedProjects:0,avgProjectValue:0}),[eE,eU]=(0,r.useState)([]);(0,r.useEffect)(()=>{!async function(){if(!Y||$)return;em(null),ec(!0);let e=(0,w.createClient)();try{let{data:s,error:t}=await e.from("projects").select("*, clients(company_name)").order("created_at",{ascending:!1});if(t)return void em("Unable to load projects right now. Please retry.");let{data:a,error:r}=await e.from("invoices").select("*, clients(company_name)").order("created_at",{ascending:!1});if(r)return void em("Unable to load invoices right now. Please retry.");let{data:l,error:i}=await e.from("clients").select("*").order("created_at",{ascending:!1});if(i)return void em("Unable to load clients right now. Please retry.");let{data:n,error:d}=await e.from("milestones").select("*, projects(name)").in("status",["pending","in_progress"]).order("due_date",{ascending:!0}).limit(5);if(d)return void em("Unable to load milestones right now. Please retry.");G(s||[]),Q(a||[]),J(l||[]),X(n||[]);let c=a?.filter(e=>"paid"===e.status)?.reduce((e,s)=>e+(s.total||0),0)||0,o=s?.filter(e=>"in_progress"===e.status).length||0,m=a?.filter(e=>"pending"===e.status)?.reduce((e,s)=>e+(s.total||0),0)||0,x=l?.length||0,u=s?.filter(e=>"completed"===e.status).length||0,h=new Date,p=a?.filter(e=>"pending"===e.status&&e.due_date&&new Date(e.due_date)<h).length||0,g=s?.reduce((e,s)=>e+(s.budget||0),0)||0,j=s&&s.length>0?g/s.length:0,f=s?.reduce((e,s)=>(e[s.service_type]=(e[s.service_type]||0)+1,e),{})||{},v=Object.values(f).reduce((e,s)=>e+s,0),N=Object.entries(f).map(([e,s])=>({service_type:e,count:s,percentage:v>0?s/v*100:0}));eU(N),eM({totalRevenue:c,activeProjects:o,pendingInvoices:m,totalClients:x,overdueInvoices:p,completedProjects:u,avgProjectValue:j}),el(!0);let{data:b,error:C}=await e.from("employee_tasks").select("id, title, proposed_project_name, proposed_project_status, proposed_project_notes, user_id, created_at, projects(name), users:users!employee_tasks_user_id_fkey(full_name, email)").not("proposed_project_name","is",null).eq("proposed_project_status","pending").order("created_at",{ascending:!1});C||es(b||[]),el(!1),ev(!0);let{data:w,error:y}=await e.from("users").select("id, email, full_name, role, company_name, created_at, status").eq("status","pending").order("created_at",{ascending:!0});y||ej(w||[]),ev(!1)}catch(e){console.error("Error fetching dashboard data:",e),em("Something went wrong while loading your dashboard. Please refresh.")}finally{ec(!1)}}()},[Y?.id,$]);let eV=(e,s="created_at")=>{let t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate());return e.filter(e=>{if("all"===ex)return!0;let r=e[s]?new Date(e[s]):null;if(!r)return!1;let l=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(ex){case"day":return l.getTime()===a.getTime();case"week":{let e=new Date(a);return e.setDate(e.getDate()-7),l>=e&&l<=a}case"month":return r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear();case"quarter":{let e=Math.floor(t.getMonth()/3);return Math.floor(r.getMonth()/3)===e&&r.getFullYear()===t.getFullYear()}case"year":return r.getFullYear()===t.getFullYear();default:return!0}})},eH=(e=eV(O),I=(T=eV(K)).filter(e=>"paid"===e.status).reduce((e,s)=>e+(s.total||0),0)||0,F=e.filter(e=>"in_progress"===e.status).length||0,R=T.filter(e=>"pending"===e.status).reduce((e,s)=>e+(s.total||0),0)||0,M=e.filter(e=>"completed"===e.status).length||0,E=new Date,U=T.filter(e=>"pending"===e.status&&e.due_date&&new Date(e.due_date)<E).length||0,V=e.reduce((e,s)=>e+(s.budget||0),0)||0,H=e.length>0?V/e.length:0,{totalRevenue:I,activeProjects:F,pendingInvoices:R,totalClients:W.length,overdueInvoices:U,completedProjects:M,avgProjectValue:H}),ez=async(e,s)=>{eb(e);let t=await P({userId:e,decision:s});t.success?ej(s=>s.filter(s=>s.id!==e)):(console.error("Failed to update user status",t.error),em(t.error||"Could not update user status. Please retry.")),eb(null)},eY=async(e,s)=>{en(!0);let t=et[e],a=await B({taskId:e,decision:s,projectId:t&&"none"!==t?t:void 0});if(a.error)alert(a.error);else{let e=(0,w.createClient)(),{data:s}=await e.from("employee_tasks").select("id, title, proposed_project_name, proposed_project_status, proposed_project_notes, user_id, created_at, projects(name), users:users!employee_tasks_user_id_fkey(full_name, email)").not("proposed_project_name","is",null).eq("proposed_project_status","pending").order("created_at",{ascending:!1});es(s||[])}en(!1)},e$=async()=>{if(ek){eP(!0);try{let e=(0,w.createClient)(),s=await (0,L.forceConfirmEmail)(ek);if(!s.success){em(s.error||"Failed to confirm email"),eP(!1);return}let{data:t}=await e.from("users").select("id, email, status").eq("email",ek).limit(1).single();if(!t?.id){em("User not found in users table"),eP(!1);return}let a=await P({userId:t.id,decision:"approved"});if(!a.success){em(a.error||"Failed to approve user"),eP(!1);return}ej(e=>e.filter(e=>e.email!==ek)),eT(""),em(null)}catch(e){em(e?.message||"Unexpected error while confirming & approving")}finally{eP(!1)}}};if($||ed)return(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})});if(eo)return(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,s.jsxs)(i.Card,{className:"max-w-lg w-full",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsx)(i.CardTitle,{children:"Dashboard unavailable"}),(0,s.jsx)(i.CardDescription,{children:eo})]}),(0,s.jsxs)(i.CardContent,{className:"flex gap-2",children:[(0,s.jsx)(n.Button,{onClick:()=>q.refresh(),children:"Retry"}),(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>window.location.reload(),children:"Hard reload"})]})]})});O.slice(0,5);let eq=K.slice(0,5),eO=W.slice(0,5);return(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:gap-6",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight select-none",onDoubleClick:()=>ew(!0),title:"",children:"Dashboard"}),(0,s.jsx)("p",{className:"text-sm md:text-base text-muted-foreground mt-1",children:"Welcome back! Here's an overview of your business."})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,s.jsxs)(n.Button,{onClick:()=>q.push("/dashboard/projects"),className:"w-full sm:w-auto",children:[(0,s.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"New Project"]}),(0,s.jsxs)(n.Button,{variant:"outline",onClick:()=>q.push("/dashboard/clients"),className:"w-full sm:w-auto",children:[(0,s.jsx)(p.Users,{className:"h-4 w-4 mr-2"}),"Add Client"]}),(0,s.jsxs)(n.Button,{variant:"outline",onClick:()=>q.push("/dashboard/invoices"),className:"w-full sm:w-auto",children:[(0,s.jsx)(x.FileText,{className:"h-4 w-4 mr-2"}),"Create Invoice"]})]})]}),(0,s.jsx)(d.Dialog,{open:eC,onOpenChange:ew,children:(0,s.jsxs)(d.DialogContent,{children:[(0,s.jsxs)(d.DialogHeader,{children:[(0,s.jsx)(d.DialogTitle,{children:"Admin Tools"}),(0,s.jsx)(d.DialogDescription,{children:"Grant admin or confirm email for a user"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"grant-admin-email",className:"text-sm",children:"Grant Admin by Email"}),(0,s.jsx)(D.Input,{id:"grant-admin-email",value:ey,onChange:e=>e_(e.target.value),placeholder:"user@example.com",type:"email"})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(n.Button,{disabled:eS||!ey,onClick:async()=>{eD(!0);let e=await A(ey);e.success?(em(null),e_("")):em(e.error||"Failed to grant admin"),eD(!1)},children:eS?"Grantingâ€¦":"Grant Admin"})}),(0,s.jsxs)("div",{className:"space-y-2 pt-3 border-t",children:[(0,s.jsx)("label",{htmlFor:"confirm-email",className:"text-sm",children:"Force Confirm Email"}),(0,s.jsx)(D.Input,{id:"confirm-email",value:eA,onChange:e=>eL(e.target.value),placeholder:"client@example.com",type:"email"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n.Button,{variant:"secondary",disabled:eI||!eA,onClick:async()=>{eF(!0);let e=await (0,L.forceConfirmEmail)(eA);e.success?(em(null),eL("")):em(e.error||"Failed to confirm email"),eF(!1)},children:eI?"Confirmingâ€¦":"Confirm Email"}),(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>ew(!1),children:"Close"})]}),eo&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Hint: double-click the â€œDashboardâ€ title to open this."})]})]})}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:[{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Quarter",value:"quarter"},{label:"Year",value:"year"},{label:"All",value:"all"}].map(e=>(0,s.jsx)(n.Button,{variant:ex===e.value?"default":"outline",size:"sm",onClick:()=>eu(e.value),children:e.label},e.value))}),(0,s.jsxs)(i.Card,{className:"border-yellow-300 bg-yellow-50 dark:bg-yellow-900/20",children:[(0,s.jsxs)(i.CardHeader,{className:"space-y-1",children:[(0,s.jsx)(i.CardTitle,{className:"text-sm md:text-base",children:"Unconfirmed accounts"}),(0,s.jsx)(i.CardDescription,{className:"text-xs md:text-sm",children:"Some legacy signups may still require email confirmation. Quickly confirm and approve a client by email."})]}),(0,s.jsxs)(i.CardContent,{className:"flex flex-col sm:flex-row gap-2",children:[(0,s.jsx)(D.Input,{placeholder:"client@example.com",type:"email",value:ek,onChange:e=>eT(e.target.value),className:"sm:max-w-xs"}),(0,s.jsx)(n.Button,{onClick:e$,disabled:eB||!ek,children:eB?"Processingâ€¦":"Confirm + Approve"})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 auto-rows-max",children:[(0,s.jsx)(l.StatCard,{title:"Total Revenue",value:`â‚¹${eH.totalRevenue.toLocaleString()}`,change:"From paid invoices",trend:"up",icon:o.DollarSign}),(0,s.jsx)(l.StatCard,{title:"Active Projects",value:eH.activeProjects.toString(),change:`${eH.completedProjects} completed`,trend:"up",icon:m.FolderKanban}),(0,s.jsx)(l.StatCard,{title:"Total Clients",value:eH.totalClients.toString(),change:"Client relationships",trend:"up",icon:p.Users}),(0,s.jsx)(i.Card,{className:"p-6 sm:row-span-2 lg:col-span-1",children:(0,s.jsxs)("div",{className:"space-y-2 h-full flex flex-col justify-center",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Project Amount"}),(0,s.jsxs)("p",{className:"text-3xl font-bold",children:["â‚¹",Math.round(eV(O).reduce((e,s)=>e+(s.budget||0),0)/1e3),"k"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"all"===ex?"All time":`This ${ex}`})]})}),(0,s.jsx)(l.StatCard,{title:"Pending Invoices",value:`â‚¹${eH.pendingInvoices.toLocaleString()}`,change:`${eH.overdueInvoices} overdue`,trend:eH.overdueInvoices>0?"down":"neutral",icon:v}),(0,s.jsx)(l.StatCard,{title:"Avg Project Value",value:`â‚¹${Math.round(eH.avgProjectValue).toLocaleString()}`,change:"Per project",trend:"up",icon:g.TrendingUp}),(0,s.jsx)(l.StatCard,{title:"Completion Rate",value:`${eV(O).length>0?Math.round(eH.completedProjects/eV(O).length*100):0}%`,change:`${eH.completedProjects}/${eV(O).length} projects`,trend:"up",icon:f.CheckCircle2}),(0,s.jsx)(l.StatCard,{title:"Pending Approvals",value:eg.length.toString(),change:"Awaiting admin review",trend:"neutral",icon:N.Bell})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsxs)(i.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.CardTitle,{className:"text-lg md:text-xl",children:"Account Approvals"}),(0,s.jsx)(i.CardDescription,{className:"text-xs md:text-sm",children:"Approve or reject newly registered users"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(y.Badge,{variant:"outline",className:"flex items-center gap-1",children:[(0,s.jsx)(b.Clock,{className:"h-4 w-4"}),eg.length," pending"]}),ef&&(0,s.jsx)(y.Badge,{variant:"secondary",children:"Loading..."})]})]}),(0,s.jsx)(i.CardContent,{className:"space-y-3",children:ef?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading pending users..."}):0===eg.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No pending accounts right now."}):eg.map(e=>(0,s.jsxs)("div",{className:"p-3 border rounded-lg flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"font-semibold",children:e.full_name||e.email}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.email}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(y.Badge,{variant:"secondary",children:e.role}),e.company_name&&(0,s.jsx)("span",{children:e.company_name}),e.created_at&&(0,s.jsxs)("span",{children:["Joined ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsx)(n.Button,{size:"sm",variant:"default",disabled:eN===e.id,onClick:()=>ez(e.id,"approved"),children:"Approve"}),"client"===e.role&&(0,s.jsx)(n.Button,{size:"sm",variant:"secondary",disabled:eN===e.id,onClick:async()=>{eb(e.id);let s=await (0,L.forceConfirmEmail)(e.email);s.success?em(null):em(s.error||"Failed to confirm email"),eb(null)},children:"Confirm Email"}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",disabled:eN===e.id,onClick:()=>ez(e.id,"rejected"),children:"Reject"})]})]},e.id))})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsxs)(i.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.CardTitle,{className:"text-lg md:text-xl",children:"Project Proposals from Employees"}),(0,s.jsx)(i.CardDescription,{className:"text-xs md:text-sm",children:"Approve or reject tasks that propose new projects"})]}),er&&(0,s.jsx)(y.Badge,{variant:"outline",children:"Loading..."})]}),(0,s.jsx)(i.CardContent,{children:0===ee.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No pending proposals right now."}):(0,s.jsx)("div",{className:"space-y-3",children:ee.map(e=>(0,s.jsxs)("div",{className:"p-3 border rounded-lg space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("p",{className:"font-semibold",children:e.proposed_project_name}),e.proposed_project_vertical&&(0,s.jsxs)(y.Badge,{variant:"secondary",className:"text-xs",children:["video_production"===e.proposed_project_vertical&&"ğŸ¬ Video Production","social_media"===e.proposed_project_vertical&&"ğŸ“± Social Media","design_branding"===e.proposed_project_vertical&&"ğŸ¨ Design & Branding"]})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Task: ",e.title]}),e.users?.full_name&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["From: ",e.users.full_name," (",e.users.email,")"]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Created ",new Date(e.created_at).toLocaleString()]}),e.projects?.name&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Currently mapped: ",e.projects.name]})]}),(0,s.jsx)("div",{className:"w-48",children:(0,s.jsxs)(S.Select,{value:et[e.id]||"none",onValueChange:s=>ea({...et,[e.id]:s}),children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{placeholder:"Attach to project (optional)"})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"none",children:"No project yet"}),O.map(e=>(0,s.jsx)(S.SelectItem,{value:e.id,children:e.name},e.id))]})]})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n.Button,{size:"sm",variant:"default",disabled:ei,onClick:()=>eY(e.id,"approved"),children:"Approve"}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",disabled:ei,onClick:()=>eY(e.id,"rejected"),children:"Reject"})]})]},e.id))})})]}),O.length>0&&(0,s.jsxs)(i.Card,{children:[(0,s.jsxs)(i.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.CardTitle,{className:"text-lg md:text-xl",children:"Service Breakdown"}),(0,s.jsx)(i.CardDescription,{className:"text-xs md:text-sm",children:"Projects by service vertical"})]}),(0,s.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>q.push("/dashboard/analytics"),className:"w-full sm:w-auto",children:"View Analytics"})]}),(0,s.jsx)(i.CardContent,{children:(0,s.jsxs)(_.Tabs,{defaultValue:"video_production",className:"w-full",children:[(0,s.jsxs)(_.TabsList,{className:"flex flex-wrap",children:[(0,s.jsx)(_.TabsTrigger,{value:"video_production",children:"Video Production"}),(0,s.jsx)(_.TabsTrigger,{value:"social_media",children:"Social Media"}),(0,s.jsx)(_.TabsTrigger,{value:"design_branding",children:"Design & Branding"})]}),(0,s.jsx)(_.TabsContent,{value:"video_production",children:(0,s.jsx)("div",{className:"space-y-3",children:0===O.filter(e=>"video_production"===e.service_type).length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No video production projects yet"}):O.filter(e=>"video_production"===e.service_type).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>ep(e),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.clients?.company_name||"No client"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.budget&&(0,s.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",e.budget.toLocaleString()]}),(0,s.jsx)(C.StatusBadge,{status:e.status})]})]},e.id))})}),(0,s.jsx)(_.TabsContent,{value:"social_media",children:(0,s.jsx)("div",{className:"space-y-3",children:0===O.filter(e=>"social_media"===e.service_type).length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No social media projects yet"}):O.filter(e=>"social_media"===e.service_type).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>ep(e),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.clients?.company_name||"No client"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.budget&&(0,s.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",e.budget.toLocaleString()]}),(0,s.jsx)(C.StatusBadge,{status:e.status})]})]},e.id))})}),(0,s.jsx)(_.TabsContent,{value:"design_branding",children:(0,s.jsx)("div",{className:"space-y-3",children:0===O.filter(e=>"design_branding"===e.service_type).length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No design & branding projects yet"}):O.filter(e=>"design_branding"===e.service_type).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>ep(e),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.clients?.company_name||"No client"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.budget&&(0,s.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",e.budget.toLocaleString()]}),(0,s.jsx)(C.StatusBadge,{status:e.status})]})]},e.id))})})]})})]}),(0,s.jsxs)("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(i.CardTitle,{className:"text-lg md:text-xl",children:"Recent Clients"}),(0,s.jsx)(i.CardDescription,{className:"text-xs md:text-sm",children:"Latest client additions"})]})}),(0,s.jsx)(i.CardContent,{children:0===eO.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(p.Users,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No clients yet"})]}):(0,s.jsx)("div",{className:"space-y-3",children:eO.map(e=>{let t=O.filter(s=>s.client_id===e.id),a=[...new Set(t.map(e=>e.service_type))];return(0,s.jsxs)("div",{className:"p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.company_name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.contact_person})]}),(0,s.jsxs)(y.Badge,{variant:"outline",className:"text-xs",children:[t.length," ",1===t.length?"project":"projects"]})]}),a.length>0&&(0,s.jsx)("div",{className:"flex gap-1 flex-wrap",children:a.map(e=>{let t=k.SERVICE_TYPES[e];return(0,s.jsxs)(y.Badge,{variant:"outline",className:"text-xs",children:[t.icon," ",t.label]},e)})})]},e.id)})})})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsxs)(i.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.CardTitle,{className:"text-lg md:text-xl",children:"Recent Invoices"}),(0,s.jsx)(i.CardDescription,{className:"text-xs md:text-sm",children:"Latest billing activity"})]}),(0,s.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>q.push("/dashboard/invoices"),className:"w-full sm:w-auto",children:"View All"})]}),(0,s.jsx)(i.CardContent,{children:0===eq.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(x.FileText,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No invoices yet"}),(0,s.jsxs)(n.Button,{onClick:()=>q.push("/dashboard/invoices"),className:"mt-4",size:"sm",children:[(0,s.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Create Invoice"]})]}):(0,s.jsx)("div",{className:"space-y-3",children:eq.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>q.push("/dashboard/invoices"),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.invoice_number}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.clients?.company_name||"No client"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,s.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",e.total?.toLocaleString()]}),(0,s.jsx)(C.StatusBadge,{status:e.status})]})]},e.id))})})]})]}),eR.overdueInvoices>0&&(z=K.filter(e=>"pending"===e.status&&e.due_date&&new Date(e.due_date)<new Date),(0,s.jsxs)(i.Card,{className:"border-red-500/50 bg-red-500/5",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.AlertCircle,{className:"h-5 w-5 text-red-500"}),(0,s.jsx)(i.CardTitle,{className:"text-red-500",children:"Overdue Invoices"})]}),(0,s.jsx)(i.CardDescription,{children:"These invoices are past their due date"})]}),(0,s.jsxs)(i.CardContent,{children:[(0,s.jsx)("div",{className:"space-y-3",children:z.slice(0,5).map(e=>{let t=Math.floor((new Date().getTime()-new Date(e.due_date).getTime())/864e5);return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-red-500/20 bg-background cursor-pointer hover:bg-accent transition-colors",onClick:()=>q.push("/dashboard/invoices"),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:e.invoice_number}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.clients?.company_name||"No client"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,s.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",e.total?.toLocaleString()]}),(0,s.jsxs)(y.Badge,{variant:"destructive",className:"text-xs",children:[t," day",1!==t?"s":""," overdue"]})]})]},e.id)})}),z.length>5&&(0,s.jsxs)(n.Button,{variant:"ghost",size:"sm",className:"w-full mt-4",onClick:()=>q.push("/dashboard/invoices"),children:["View all ",z.length," overdue invoices"]})]})]})),Z.length>0&&(0,s.jsxs)(i.Card,{children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsx)(i.CardTitle,{children:"Upcoming Milestones"}),(0,s.jsx)(i.CardDescription,{children:"Important deadlines to track"})]}),(0,s.jsx)(i.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:Z.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(h.Calendar,{className:"h-4 w-4 mt-1 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.projects?.name||"No project"})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.due_date?new Date(e.due_date).toLocaleDateString():"No date"}),(0,s.jsx)(y.Badge,{variant:"outline",className:"text-xs mt-1",children:e.status})]})]},e.id))})})]}),(0,s.jsx)(d.Dialog,{open:!!eh,onOpenChange:e=>!e&&ep(null),children:(0,s.jsxs)(d.DialogContent,{className:"max-w-4xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,s.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),eh&&(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)(d.DialogHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(d.DialogTitle,{className:"text-2xl",children:eh.name}),(0,s.jsxs)(d.DialogDescription,{className:"mt-2",children:["Client: ",eh.clients?.company_name||"No client"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(y.Badge,{variant:(e=>{switch(e){case"video_production":return"default";case"social_media":default:return"secondary";case"design_branding":return"outline"}})(eh.service_type),children:[(0,s.jsx)("span",{className:"mr-1",children:k.SERVICE_TYPES[eh.service_type]?.icon}),k.SERVICE_TYPES[eh.service_type]?.label||eh.service_type]}),(0,s.jsx)(C.StatusBadge,{status:eh.status})]})]})}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-3",children:"Project Overview"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[eh.budget&&(0,s.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,s.jsx)(o.DollarSign,{className:"h-3 w-3"}),"Budget"]}),(0,s.jsxs)("p",{className:"font-semibold",children:["â‚¹",eh.budget.toLocaleString()]})]}),eh.start_date&&(0,s.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,s.jsx)(h.Calendar,{className:"h-3 w-3"}),"Start Date"]}),(0,s.jsx)("p",{className:"font-semibold",children:new Date(eh.start_date).toLocaleDateString()})]}),eh.deadline&&(0,s.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,s.jsx)(h.Calendar,{className:"h-3 w-3"}),"Deadline"]}),(0,s.jsx)("p",{className:"font-semibold",children:new Date(eh.deadline).toLocaleDateString()})]}),(0,s.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,s.jsx)(g.TrendingUp,{className:"h-3 w-3"}),"Progress"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Progress,{value:eh.progress_percentage||0,className:"h-2 flex-1"}),(0,s.jsxs)("span",{className:"font-semibold text-sm",children:[eh.progress_percentage||0,"%"]})]})]})]})]}),eh.description&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Description"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:eh.description})]}),(0,s.jsx)(n.Button,{onClick:()=>{q.push(`/dashboard/projects?id=${eh.id}`),ep(null)},className:"w-full",children:"View Full Details"})]})]})]})})]})}function F(){let{user:e,loading:l}=(0,t.useAuth)(),i=(0,a.useRouter)();return((0,r.useEffect)(()=>{!l&&e&&("client"===e.role?i.push("/dashboard/client"):("employee"===e.role||"project_manager"===e.role)&&i.push("/dashboard/employee"))},[l,e,i]),l)?(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})}):e?.role==="admin"?(0,s.jsx)(I,{}):(0,s.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Redirecting..."})})}e.s(["default",()=>F],78928)}]);