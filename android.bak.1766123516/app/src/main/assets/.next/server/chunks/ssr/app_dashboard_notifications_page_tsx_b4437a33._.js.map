{"version":3,"sources":["../../../../app/dashboard/notifications/page.tsx","../../../../app/actions/data%3A362e0f%20%3Ctext/javascript%3E"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { useAuth } from '@/contexts/auth-context'\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { markAllNotificationsRead } from '@/app/actions/notifications'\n\nexport default function NotificationsPage() {\n    const { user } = useAuth()\n    const [items, setItems] = useState<any[]>([])\n    const [loading, setLoading] = useState(true)\n    const [marking, setMarking] = useState(false)\n\n    useEffect(() => {\n        async function fetchNotifications() {\n            if (!user) return\n            const supabase = createClient()\n            setLoading(true)\n            try {\n                const { data } = await supabase\n                    .from('notifications')\n                    .select('*')\n                    .eq('user_id', user.id)\n                    .order('created_at', { ascending: false })\n                    .limit(200)\n                setItems(data || [])\n            } catch (e) {\n                console.error('Failed to fetch notifications', e)\n            } finally {\n                setLoading(false)\n            }\n        }\n        fetchNotifications()\n    }, [user?.id])\n\n    const markAll = async () => {\n        if (!user) return\n        setMarking(true)\n        const res = await markAllNotificationsRead(user.id)\n        if (res.success) {\n            setItems(prev => prev.map(n => ({ ...n, read: true })))\n        }\n        setMarking(false)\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            <Card>\n                <CardHeader className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2\">\n                    <div>\n                        <CardTitle>Notifications</CardTitle>\n                        <CardDescription>In-app alerts for comments and assignments</CardDescription>\n                    </div>\n                    <Button variant=\"outline\" size=\"sm\" onClick={markAll} disabled={marking}>Mark all read</Button>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                    {loading ? (\n                        <p className=\"text-sm text-muted-foreground\">Loadingâ€¦</p>\n                    ) : items.length === 0 ? (\n                        <p className=\"text-sm text-muted-foreground\">No notifications</p>\n                    ) : (\n                        items.map((n) => (\n                            <div key={n.id} className={`p-3 border rounded-lg ${n.read ? 'bg-background' : 'bg-accent/20'}`}>\n                                <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\n                                    <span>{n.type}</span>\n                                    <span>{new Date(n.created_at).toLocaleString()}</span>\n                                </div>\n                                <p className=\"text-sm\">{n.message}</p>\n                            </div>\n                        ))\n                    )}\n                </CardContent>\n            </Card>\n        </div>\n    )\n}\n","/* __next_internal_action_entry_do_not_use__ [{\"408c33e2053a5e4ec12804d77b9a527496c0be7d31\":\"markAllNotificationsRead\"},\"app/actions/notifications.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var markAllNotificationsRead=/*#__PURE__*/createServerReference(\"408c33e2053a5e4ec12804d77b9a527496c0be7d31\",callServer,void 0,findSourceMapURL,\"markAllNotificationsRead\");"],"names":[],"mappings":"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"}