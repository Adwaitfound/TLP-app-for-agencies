module.exports=[92611,a=>{"use strict";var b=a.i(37936),c=a.i(98310);async function d(a,b=3600){let e=await (0,c.createClient)(),f=(0,c.createServiceClient)(),{data:{user:g},error:h}=await e.auth.getUser();if(h||!g)return{error:"Unauthorized"};try{var i=g.email||void 0;if(!i)throw Error("Unauthorized");if("adwait@thelostproject.in"!==i)throw Error("Access restricted");let{bucket:c,path:d}=function(a,b="project-files"){let c=function(a){try{let b=new URL(a).pathname.split("/").filter(Boolean),c=b.findIndex(a=>"object"===a);if(-1===c||c+2>=b.length)return null;b[c+1];let d=b[c+2],e=b.slice(c+3).join("/");if(!d||!e)return null;return{bucket:d,path:e}}catch{return null}}(a);if(c)return c;let d=`${b}/`,e=a.indexOf(d);return{bucket:b,path:(e>=0?a.slice(e+d.length):a).replace(/^public\//,"").replace(/^\//,"")}}(a),{data:e,error:h}=await f.storage.from(c).createSignedUrl(d,b);if(h)throw h;return{signedUrl:e?.signedUrl}}catch(a){return console.error("Signed URL error:",a),{error:a.message||"Failed to generate signed URL"}}}(0,a.i(13095).ensureServerEntryExports)([d]),(0,b.registerServerReference)(d,"609ad8544995b5847b0ce8a82278134f0856ad1454",null),a.s(["getSignedProjectFileUrl",()=>d])},73222,a=>{"use strict";var b=a.i(74779),c=a.i(92611),d=a.i(37936),e=a.i(98310),f=a.i(13095);function g(a){if(!a)throw Error("Unauthorized");if("adwait@thelostproject.in"!==a)throw Error("Access restricted")}async function h(a){let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(d||!c)return{error:"Unauthorized"};try{g(c.email||void 0);let b=(0,e.createServiceClient)(),{data:d,error:f}=await b.from("milestones").insert({project_id:a.project_id,title:a.title,description:a.description||null,due_date:a.due_date||null,status:a.status||"pending",created_by_email:c.email}).select("*").single();if(f)throw f;return{data:d}}catch(a){return{error:a.message||"Failed to create milestone"}}}async function i(a,b){let c=await (0,e.createClient)(),{data:{user:d},error:f}=await c.auth.getUser();if(f||!d)return{error:"Unauthorized"};try{g(d.email||void 0);let c=(0,e.createServiceClient)(),{data:f,error:h}=await c.from("milestones").update({status:b}).eq("id",a).select("*").single();if(h)throw h;return{data:f}}catch(a){return{error:a.message||"Failed to update milestone"}}}async function j(a){let b=await (0,e.createClient)(),{data:{user:c},error:d}=await b.auth.getUser();if(d||!c)return{error:"Unauthorized"};try{g(c.email||void 0);let b=(0,e.createServiceClient)(),{error:d}=await b.from("milestones").delete().eq("id",a);if(d)throw d;return{success:!0}}catch(a){return{error:a.message||"Failed to delete milestone"}}}async function k(a,b){let c=await (0,e.createClient)(),{data:{user:d},error:f}=await c.auth.getUser();if(f||!d)return{error:"Unauthorized"};try{g(d.email||void 0);let c=(0,e.createServiceClient)(),f=b.map((b,c)=>({id:b,position:c,project_id:a})),{error:h}=await c.from("milestones").upsert(f,{onConflict:"id"});if(h)throw h;return{success:!0}}catch(a){return{error:a.message||"Failed to reorder milestones"}}}(0,f.ensureServerEntryExports)([h,i,j,k]),(0,d.registerServerReference)(h,"40a4dbbba46d42778ca13443447c1eace251478be0",null),(0,d.registerServerReference)(i,"60e5c3f9efb3e2af71ede94483ceab393987c93573",null),(0,d.registerServerReference)(j,"40976afb0bc8b7c7b1a06e4d2172dc94d38c18b70d",null),(0,d.registerServerReference)(k,"60c29a5b0ec53ee83fb282f4164f20fbb4cca62056",null);var l=a.i(18558);async function m(a){let b=await (0,e.createClient)(),{data:c,error:d}=await b.from("calendar_events").insert({project_id:a.project_id,event_date:a.event_date,title:a.title,copy:a.copy,platform:a.platform,content_type:a.content_type,status:a.status??"idea",ig_link:a.ig_link,yt_link:a.yt_link,attachments:a.attachments?JSON.stringify(a.attachments):JSON.stringify([])}).select("*").single();if(d)throw Error(d.message);return(0,l.revalidatePath)("/dashboard/projects"),c}async function n(a,b){let c=await (0,e.createClient)(),{data:d,error:f}=await c.from("calendar_events").update({...void 0!==b.title&&{title:b.title},...void 0!==b.copy&&{copy:b.copy},...void 0!==b.platform&&{platform:b.platform},...void 0!==b.content_type&&{content_type:b.content_type},...void 0!==b.status&&{status:b.status},...void 0!==b.ig_link&&{ig_link:b.ig_link},...void 0!==b.yt_link&&{yt_link:b.yt_link},...void 0!==b.attachments&&{attachments:JSON.stringify(b.attachments)}}).eq("id",a).select("*").single();if(f)throw Error(f.message);return(0,l.revalidatePath)("/dashboard/projects"),d}async function o(a){let b=await (0,e.createClient)(),{error:c}=await b.from("calendar_events").delete().eq("id",a);if(c)throw Error(c.message);(0,l.revalidatePath)("/dashboard/projects")}async function p(a,b){let c=await (0,e.createClient)(),d=new Date(b),f=new Date(d.getFullYear(),d.getMonth(),1).toISOString().slice(0,10),g=new Date(d.getFullYear(),d.getMonth()+1,0).toISOString().slice(0,10),{data:h,error:i}=await c.from("calendar_events").select("*").eq("project_id",a).gte("event_date",f).lte("event_date",g).order("event_date",{ascending:!0});if(i)throw Error(i.message);return h}(0,f.ensureServerEntryExports)([m,n,o,p]),(0,d.registerServerReference)(m,"402c40f1248f942cb86ca82d64406c24bccf9cd9f8",null),(0,d.registerServerReference)(n,"60b6756cfc70cd7d7fa5fb7b854a8371f2376414a6",null),(0,d.registerServerReference)(o,"4040a7ed52ad3b81aa998665830614d31c6c2a70b4",null),(0,d.registerServerReference)(p,"6069b06d93201d992f20335d654a277635cdc8d5f9",null),a.s([],49978),a.i(49978),a.s(["4001860d967ff1d29143ee49c09c9bbdff4d1af8fb",()=>b.logAuditEvent,"402c40f1248f942cb86ca82d64406c24bccf9cd9f8",()=>m,"4040a7ed52ad3b81aa998665830614d31c6c2a70b4",()=>o,"40976afb0bc8b7c7b1a06e4d2172dc94d38c18b70d",()=>j,"40a4dbbba46d42778ca13443447c1eace251478be0",()=>h,"6069b06d93201d992f20335d654a277635cdc8d5f9",()=>p,"609ad8544995b5847b0ce8a82278134f0856ad1454",()=>c.getSignedProjectFileUrl,"60b6756cfc70cd7d7fa5fb7b854a8371f2376414a6",()=>n,"60e5c3f9efb3e2af71ede94483ceab393987c93573",()=>i],73222)},85685,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[externals]_crypto_c412f66b._.js"].map(b=>a.l(b))).then(()=>b(54799)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5e7431d4._.js.map