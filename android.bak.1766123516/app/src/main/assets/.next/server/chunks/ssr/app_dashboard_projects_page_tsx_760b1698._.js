module.exports=[94229,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(3130),f=a.i(40695),g=a.i(5522),h=a.i(87682),i=a.i(17171),j=a.i(46893),k=a.i(2150),l=a.i(94861),m=a.i(65733),n=a.i(39786),o=a.i(15618),p=a.i(87532),q=a.i(41675),r=a.i(90166),s=a.i(96221),t=a.i(63416),u=a.i(64791),v=a.i(77156);let w=(0,a.i(70106).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var x=a.i(81560),y=a.i(60246),z=a.i(4720),A=a.i(87534),B=a.i(24669),C=a.i(41710);a.i(38632),a.i(35487);var D=a.i(46864),E=a.i(15659),F=a.i(69240),G=a.i(52813),H=a.i(38422),I=a.i(54161),J=a.i(41800),K=a.i(5050),L=(0,K.createServerReference)("40a4dbbba46d42778ca13443447c1eace251478be0",K.callServer,void 0,K.findSourceMapURL,"createMilestone"),M=(0,K.createServerReference)("60e5c3f9efb3e2af71ede94483ceab393987c93573",K.callServer,void 0,K.findSourceMapURL,"updateMilestoneStatus"),N=(0,K.createServerReference)("40976afb0bc8b7c7b1a06e4d2172dc94d38c18b70d",K.callServer,void 0,K.findSourceMapURL,"deleteMilestone");function O(){let{user:K}=(0,H.useAuth)(),O=(0,d.useSearchParams)(),[P,Q]=(0,c.useState)([]),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)({}),[V,W]=(0,c.useState)({}),[X,Y]=(0,c.useState)({}),[Z,$]=(0,c.useState)(!0),[_,aa]=(0,c.useState)(""),[ab,ac]=(0,c.useState)("all"),[ad,ae]=(0,c.useState)("all"),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(null),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(!1),[ar,as]=(0,c.useState)(!1),[at,au]=(0,c.useState)({}),[av,aw]=(0,c.useState)([]),[ax,ay]=(0,c.useState)(""),[az,aA]=(0,c.useState)(""),[aB,aC]=(0,c.useState)({title:"",description:"",due_date:""}),aD=[{value:"pending",label:"Pending"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"blocked",label:"Blocked"}],[aE,aF]=(0,c.useState)({name:"",client_id:"",description:"",service_type:"video_production",budget:"",start_date:"",deadline:"",status:"planning",progress_percentage:0}),[aG,aH]=(0,c.useState)({}),[aI,aJ]=(0,c.useState)(null),[aK,aL]=(0,c.useState)(!1),[aM,aN]=(0,c.useState)(!1),[aO,aP]=(0,c.useState)({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),[aQ,aR]=(0,c.useState)({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),[aS,aT]=(0,c.useState)({}),[aU,aV]=(0,c.useState)({}),[aW,aX]=(0,c.useState)(""),[aY,aZ]=(0,c.useState)(""),[a$,a_]=(0,c.useState)(!1),[a0,a1]=(0,c.useState)({name:"",client_id:"",description:"",service_type:"video_production",budget:"",start_date:"",deadline:"",status:"planning"});async function a2(){l.debug.log("FETCH_DATA","Starting data fetch...");let a=(0,F.createClient)();$(!0);try{let b=[];if(console.log("[ProjectsPage] ðŸ”µ FETCH START - User:",K?.id,"Email:",K?.email,"Role:",K?.role),K?.role==="project_manager"||K?.role==="employee"){console.log("[ProjectsPage] ðŸ”· Employee/PM fetch mode"),console.log("[ProjectsPage] Fetching projects created by:",K.id);let{data:c,error:d}=await a.from("projects").select("*, clients(company_name, contact_person)").eq("created_by",K.id).order("created_at",{ascending:!1});if(console.log("[ProjectsPage] Created projects result:",{count:c?.length,error:d}),d)throw d;console.log("[ProjectsPage] Fetching project_team entries for user:",K.id);let{data:e,error:f}=await a.from("project_team").select("projects(*, clients(company_name, contact_person))").eq("user_id",K.id);console.log("[ProjectsPage] Team projects result:",{count:e?.length,error:f}),f&&console.warn("[ProjectsPage] âš ï¸ Team projects query failed:",f);let g=[...c||[]],h=(e||[]).map(a=>a.projects).filter(Boolean);console.log("[ProjectsPage] Before dedup - created:",g.length,"from team:",h.length),h.forEach(a=>{g.find(b=>b.id===a.id)||g.push(a)}),console.log("[ProjectsPage] After dedup - total projects:",g.length),g.forEach(a=>console.log("[ProjectsPage] Project:",a.id,a.name)),b=g}else{console.log("[ProjectsPage] ðŸ”· Admin fetch mode - fetching ALL projects");let{data:c,error:d}=await a.from("projects").select("*, clients(company_name, contact_person)").order("created_at",{ascending:!1});if(console.log("[ProjectsPage] All projects result:",{count:c?.length,error:d}),d)throw d;b=c||[]}console.log("[ProjectsPage] âœ… Total projects to display:",b.length),l.debug.success("FETCH_DATA","Projects fetched",{count:b?.length});let{data:c,error:d}=await a.from("clients").select("*").eq("status","active").order("company_name");if(d)throw d;if(l.debug.success("FETCH_DATA","Clients fetched",{count:c?.length}),Q(b||[]),S(c||[]),b&&b.length>0){let c=b.map(a=>a.id),{data:d,error:e}=await a.from("project_files").select("*").in("project_id",c).order("created_at",{ascending:!1});if(e)throw e;let f=(d||[]).reduce((a,b)=>(a[b.project_id]=a[b.project_id]||[],a[b.project_id].push(b),a),{});U(f)}if(b&&b.length>0){let c=b.map(a=>a.id),{data:d,error:e}=await a.from("milestones").select("*").in("project_id",c).order("position",{ascending:!0}).order("due_date",{ascending:!0});if(e)console.warn("Milestones table not available:",e.message);else{let a=(d||[]).reduce((a,b)=>(a[b.project_id]=a[b.project_id]||[],a[b.project_id].push(b),a),{});W(a)}}if(b&&b.length>0){let c=[...new Set(b.map(a=>a.created_by).filter(Boolean))];if(c.length>0){let{data:b,error:d}=await a.from("users").select("*").in("id",c);if(d)throw d;let e=(b||[]).reduce((a,b)=>(a[b.id]=b,a),{});Y(e)}}if(b&&b.length>0){l.debug.log("FETCH_DATA","Fetching team members for projects...",{projectIds:b.map(a=>a.id)});let c=b.map(a=>a.id),{data:d,error:e}=await a.from("project_team").select("project_id, user_id, user:users!user_id(id, email, full_name, avatar_url, role)").in("project_id",c);if(e)l.debug.warn("FETCH_DATA","Team fetch error:",e),console.warn("Project team table not available:",e.message);else{l.debug.log("FETCH_DATA","Team data received",{rawCount:d?.length});let a=(d||[]).reduce((a,b)=>(a[b.project_id]||(a[b.project_id]=[]),b.user&&a[b.project_id].push(b.user),a),{});l.debug.success("FETCH_DATA","Team members mapped",{projectsWithTeam:Object.keys(a).length,teamMap:a}),au(a)}}if(K?.role==="admin"||K?.role==="project_manager"){let{data:b,error:c}=await a.from("users").select("*").order("full_name",{ascending:!0,nullsFirst:!1});if(c)console.error("Error fetching users:",c);else{let a=(b||[]).filter(a=>"admin"===a.role||"project_manager"===a.role||"employee"===a.role);aw(a)}}}catch(a){console.error("Error fetching data:",{message:a?.message,code:a?.code,details:a?.details,hint:a?.hint})}finally{$(!1)}}async function a3(a){if(a.preventDefault(),ah)return;ai(!0);let b=(0,F.createClient)();try{let{data:a,error:c}=await b.from("projects").insert([{name:a0.name,client_id:a0.client_id,description:a0.description,service_type:a0.service_type,budget:a0.budget?parseFloat(a0.budget):null,start_date:a0.start_date||null,deadline:a0.deadline||null,status:a0.status,progress_percentage:0,created_by:K?.id}]).select();if(c)throw c;a1({name:"",client_id:"",description:"",service_type:"video_production",budget:"",start_date:"",deadline:"",status:"planning"}),ag(!1),await a2()}catch(a){console.error("Error creating project:",a),alert(a.message||"Failed to create project")}finally{ai(!1)}}async function a4(a){if(a.preventDefault(),aj&&!ah){ai(!0);try{let{data:a,error:b}=await L({project_id:aj.id,title:aB.title,description:aB.description,due_date:aB.due_date||null,status:"pending"});if(b)throw Error(b);aC({title:"",description:"",due_date:""}),ao(!1),a&&W(b=>({...b,[aj.id]:[a,...b[aj.id]||[]]}))}catch(a){console.error("Error adding milestone:",{message:a?.message,code:a?.code,details:a?.details,hint:a?.hint}),alert(a?.message||"Failed to add milestone. The milestones table may not exist yet.")}finally{ai(!1)}}}async function a5(a,b,c){let{error:d,data:e}=await M(b,c);d?alert(d):e&&W(c=>({...c,[a]:(c[a]||[]).map(a=>a.id===b?{...a,status:e.status}:a)}))}async function a6(a,b){if(!confirm("Delete this milestone?"))return;let{error:c}=await N(b);c?alert(c):W(c=>({...c,[a]:(c[a]||[]).filter(a=>a.id!==b)}))}async function a7(a){if(a.preventDefault(),!aj||!ax||ah)return;if(l.debug.log("ASSIGN_TEAM","Start team assignment",{projectId:aj.id,userId:ax}),console.log("=== ASSIGN TEAM MEMBER START ==="),console.log("Selected Project ID:",aj.id),console.log("Selected User ID:",ax),console.log("Current projectTeam state:",at),at[aj.id]?.find(a=>a.id===ax)){l.debug.warn("ASSIGN_TEAM","User already assigned",{userId:ax}),alert("This team member is already assigned to this project");return}ai(!0);let b=(0,F.createClient)();try{let{error:a}=await b.from("project_team").insert({project_id:aj.id,user_id:ax,role:az||null,assigned_by:K?.id});if(a){if("23505"===a.code)throw Error("This team member is already assigned to this project");throw a}l.debug.success("ASSIGN_TEAM","Team member inserted",{projectId:aj.id,userId:ax}),console.log("Team member inserted successfully"),ay(""),aA(""),l.debug.log("ASSIGN_TEAM","Fetching updated team members..."),console.log("Fetching updated team members...");let c=await a9(aj.id);l.debug.success("ASSIGN_TEAM","Members updated",{members:c.map(a=>a.email)}),console.log("Updated members returned:",c),console.log("=== ASSIGN TEAM MEMBER END ===")}catch(a){l.debug.error("ASSIGN_TEAM","Assignment failed",a),console.error("Error assigning team member:",{message:a?.message,code:a?.code,details:a?.details,hint:a?.hint}),alert(a?.message||"Failed to assign team member")}finally{ai(!1)}}async function a8(a){if(!aj||!confirm("Remove this team member from the project?"))return;let b=(0,F.createClient)();try{let{error:c}=await b.from("project_team").delete().eq("project_id",aj.id).eq("user_id",a);if(c)throw c;au(b=>({...b,[aj.id]:b[aj.id]?.filter(b=>b.id!==a)||[]}))}catch(a){console.error("Error removing team member:",a),alert("Failed to remove team member")}}async function a9(a){let b=(0,F.createClient)();try{let{data:c,error:d}=await b.from("project_team").select("*, user:users!user_id(id, email, full_name, avatar_url, role)").eq("project_id",a);if(d)throw l.debug.error("FETCH_TEAM","Query error:",d),console.error("Error fetching team members:",d),d;l.debug.log("FETCH_TEAM","Raw data from query:",{projectId:a,count:c?.length}),console.log("Fetched team data:",c);let e=(c||[]).map(a=>a.user).filter(Boolean);return l.debug.success("FETCH_TEAM","Members processed",{projectId:a,members:e.map(a=>({id:a.id,email:a.email}))}),console.log("Processed team members:",e),au(b=>({...b,[a]:e})),e}catch(a){return l.debug.error("FETCH_TEAM","Exception:",a),console.error("Error in fetchProjectTeamMembers:",a),[]}}async function ba(a){let b=(0,F.createClient)();try{let{data:c,error:d}=await b.from("sub_projects").select("*, assigned_user:users!assigned_to(id, email, full_name, avatar_url, role)").eq("parent_project_id",a).order("created_at",{ascending:!1});if(d)return void console.warn("Sub-projects table not available:",d.message);aH(b=>({...b,[a]:c||[]}))}catch(a){console.error("Error fetching sub-projects:",a)}}async function bb(a){if(a.preventDefault(),!aj||ah)return;ai(!0);let b=(0,F.createClient)();try{if(!aO.name.trim())throw Error("Task name is required");let a="unassigned"===aO.assigned_to?null:aO.assigned_to,{error:c}=await b.from("sub_projects").insert({parent_project_id:aj.id,name:aO.name,description:aO.description,assigned_to:a,due_date:aO.due_date||null,status:aO.status,video_url:aO.video_url||null,created_by:K?.id});if(c)throw c;if(a){let{error:c}=await b.from("employee_tasks").insert({user_id:a,project_id:aj.id,title:aO.name,description:aO.description,due_date:aO.due_date||null,status:"todo"});c&&console.warn("Warning: Task created in sub_projects but failed to create employee task:",c)}aP({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),aL(!1),await ba(aj.id)}catch(b){console.error("Error adding sub-project:",b);let a=b?.message||b?.error_description||"Failed to add task";alert(a.includes("sub_projects")||a.includes("migration")?"Task feature not available. Please run migration 009 or contact support.":a)}finally{ai(!1)}}async function bc(a){if(a.preventDefault(),!aI||ah)return;ai(!0);let b=(0,F.createClient)();try{let a="unassigned"===aQ.assigned_to?null:aQ.assigned_to,{error:c}=await b.from("sub_projects").update({name:aQ.name,description:aQ.description,assigned_to:a,due_date:aQ.due_date||null,status:aQ.status,video_url:aQ.video_url||null}).eq("id",aI.id);if(c)throw c;if(a){let{data:c}=await b.from("employee_tasks").select("id").eq("user_id",a).eq("project_id",aj?.id).match({title:aQ.name}).single();c||await b.from("employee_tasks").insert({user_id:a,project_id:aj?.id,title:aQ.name,description:aQ.description,due_date:aQ.due_date||null,status:"todo"})}aN(!1),aJ(null),aj&&await ba(aj.id)}catch(a){console.error("Error updating sub-project:",a),alert("Failed to update task")}finally{ai(!1)}}async function bd(a,b){let c=(0,F.createClient)();try{let{error:d}=await c.from("sub_projects").update({progress_percentage:b}).eq("id",a);if(d)throw d;aj&&await ba(aj.id)}catch(a){console.error("Error updating sub-project progress:",a)}}async function be(a,b){let c=(0,F.createClient)();try{let{error:d}=await c.from("sub_projects").update({status:b,completed_at:"completed"===b?new Date().toISOString():null}).eq("id",a);if(d)throw d;aj&&await ba(aj.id)}catch(a){console.error("Error updating sub-project status:",a)}}(0,c.useEffect)(()=>{let a=O.get("service");a&&["video_production","social_media","design_branding"].includes(a)&&ae(a)},[O]),(0,c.useEffect)(()=>{a2()},[]),(0,c.useEffect)(()=>{ap&&aj&&(console.log("Team dialog opened, fetching members for project:",aj.id),a9(aj.id))},[ap,aj?.id]);let bf=P.filter(a=>{let b=a.name.toLowerCase().includes(_.toLowerCase())||a.clients?.company_name.toLowerCase().includes(_.toLowerCase()),c="all"===ab||a.status===ab,d="all"===ad||a.service_type===ad;return b&&c&&d}),bg={total:P.length,active:P.filter(a=>"in_progress"===a.status).length,completed:P.filter(a=>"completed"===a.status).length,planning:P.filter(a=>"planning"===a.status).length,totalBudget:P.reduce((a,b)=>a+(b.budget||0),0),avgProgress:P.length>0?Math.round(P.reduce((a,b)=>a+b.progress_percentage,0)/P.length):0};function bh(a){ak(a),am(!0),ba(a.id)}async function bi(a){ak(a),aq(!0),await a9(a.id)}async function bj(a){if(a.preventDefault(),aj&&!ah){ai(!0);try{let a=(0,F.createClient)(),{data:b,error:c}=await a.from("projects").update({name:aE.name,client_id:aE.client_id||null,description:aE.description||null,service_type:aE.service_type,budget:aE.budget?Number(aE.budget):null,start_date:aE.start_date||null,deadline:aE.deadline||null,status:aE.status,progress_percentage:aE.progress_percentage}).eq("id",aj.id).select().single();if(c)throw c;b&&Q(a=>a.map(a=>a.id===aj.id?{...a,...b}:a)),as(!1),await a2()}catch(a){console.error("Error updating project:",a),alert(a.message||"Failed to update project")}finally{ai(!1)}}}let bk=a=>G.SERVICE_TYPES[a]?.icon||"ðŸ“",bl=a=>G.SERVICE_TYPES[a]?.label||a,[bm,bn]=(0,c.useState)(!1),[bo,bp]=(0,c.useState)(!1),[bq,br]=(0,c.useState)(null),[bs,bt]=(0,c.useState)([]);async function bu(b){let c=prompt("Title for content?")||"New Content",d=b.toISOString().slice(0,10);if(aj)try{let b=await (await a.A(61256)).createCalendarEvent({project_id:aj.id,event_date:d,title:c,status:"idea"});bt(a=>[...a,{id:b.id,date:b.event_date,title:b.title,copy:b.copy,status:b.status}])}catch(a){console.error(a),alert("Failed to create calendar event")}}async function bv(b){try{await (await a.A(61256)).updateCalendarEvent(b.id,{title:b.title,copy:b.copy,status:b.status,attachments:b.attachments?.map(a=>({url:a.url,kind:a.kind}))}),bt(a=>a.map(a=>a.id===b.id?b:a))}catch(a){console.error(a),alert("Failed to update event")}}async function bw(b){try{await (await a.A(61256)).deleteCalendarEvent(b),bt(a=>a.filter(a=>a.id!==b))}catch(a){console.error(a),alert("Failed to delete event")}}let bx=a=>{switch(a){case"video_production":return"default";case"social_media":default:return"secondary";case"design_branding":return"outline"}};return(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:gap-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:K?.role==="project_manager"||K?.role==="employee"?"My Projects":"Projects"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:K?.role==="project_manager"||K?.role==="employee"?"All your assigned projects and collaborations":"Manage all your video production projects"})]}),K?.role==="admin"&&(0,b.jsxs)(m.Dialog,{open:af,onOpenChange:ag,children:[(0,b.jsx)(m.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{className:"w-full md:w-auto",children:[(0,b.jsx)(o.Plus,{className:"mr-2 h-4 w-4"}),"New Project"]})}),(0,b.jsx)(m.DialogContent,{className:"max-w-md md:max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:a3,children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Create New Project"}),(0,b.jsx)(m.DialogDescription,{children:"Enter the project details to get started."})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"name",children:"Project Name *"}),(0,b.jsx)(g.Input,{id:"name",placeholder:"Brand Video Production",required:!0,value:a0.name,onChange:a=>a1({...a0,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"client",children:"Client *"}),(0,b.jsxs)(h.Select,{value:a0.client_id,onValueChange:a=>a1({...a0,client_id:a}),required:!0,children:[(0,b.jsx)(h.SelectTrigger,{id:"client",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select a client"})}),(0,b.jsx)(h.SelectContent,{children:0===R.length?(0,b.jsx)(h.SelectItem,{value:"none",disabled:!0,children:"No clients available"}):R.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.company_name},a.id))})]}),0===R.length&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add a client first before creating a project"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"service",children:"Service Type *"}),(0,b.jsxs)(h.Select,{value:a0.service_type,onValueChange:a=>a1({...a0,service_type:a}),required:!0,children:[(0,b.jsx)(h.SelectTrigger,{id:"service",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select service type"})}),(0,b.jsx)(h.SelectContent,{children:Object.values(G.SERVICE_TYPES).map(a=>(0,b.jsx)(h.SelectItem,{value:a.value,children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:a.icon}),(0,b.jsx)("span",{children:a.label})]})},a.value))})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:G.SERVICE_TYPES[a0.service_type].description})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(j.Textarea,{id:"description",placeholder:"Brief project description",value:a0.description,onChange:a=>a1({...a0,description:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"budget",children:"Budget (â‚¹)"}),(0,b.jsx)(g.Input,{id:"budget",type:"number",placeholder:"10000",value:a0.budget,onChange:a=>a1({...a0,budget:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"status",children:"Status"}),(0,b.jsxs)(h.Select,{value:a0.status,onValueChange:a=>a1({...a0,status:a}),children:[(0,b.jsx)(h.SelectTrigger,{id:"status",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"planning",children:"Planning"}),(0,b.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(h.SelectItem,{value:"in_review",children:"In Review"}),(0,b.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(h.SelectItem,{value:"stuck",children:"Stuck"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"start_date",children:"Start Date"}),(0,b.jsx)(g.Input,{id:"start_date",type:"date",value:a0.start_date,onChange:a=>a1({...a0,start_date:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"deadline",children:"Deadline"}),(0,b.jsx)(g.Input,{id:"deadline",type:"date",value:a0.deadline,onChange:a=>a1({...a0,deadline:a.target.value})})]})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>ag(!1),disabled:ah,children:"Cancel"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:ah||0===R.length,children:[ah&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),ah?"Creating...":"Create Project"]})]})]})})]})]}),!Z&&P.length>0&&(0,b.jsxs)("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"pb-2",children:[(0,b.jsx)(e.CardDescription,{className:"text-xs",children:"Total Projects"}),(0,b.jsx)(e.CardTitle,{className:"text-2xl",children:bg.total})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[bg.active," active"]})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"pb-2",children:[(0,b.jsx)(e.CardDescription,{className:"text-xs",children:"Completed"}),(0,b.jsx)(e.CardTitle,{className:"text-2xl",children:bg.completed})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[P.length>0?Math.round(bg.completed/P.length*100):0,"% success rate"]})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"pb-2",children:[(0,b.jsx)(e.CardDescription,{className:"text-xs",children:"Total Budget"}),(0,b.jsxs)(e.CardTitle,{className:"text-2xl",children:["â‚¹",Math.round(bg.totalBudget/1e3),"k"]})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Across all projects"})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"pb-2",children:[(0,b.jsx)(e.CardDescription,{className:"text-xs",children:"Avg Progress"}),(0,b.jsxs)(e.CardTitle,{className:"text-2xl",children:[bg.avgProgress,"%"]})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)(k.Progress,{value:bg.avgProgress,className:"h-1"})})]})]}),(0,b.jsx)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-3",children:Object.values(G.SERVICE_TYPES).map(a=>{let c=P.filter(b=>b.service_type===a.value),d=ad===a.value;return(0,b.jsxs)(e.Card,{className:`cursor-pointer transition-all hover:shadow-lg ${d?"ring-2 ring-primary":""}`,onClick:()=>ae(d?"all":a.value),children:[(0,b.jsx)(e.CardHeader,{className:`pb-3 bg-gradient-to-br ${a.color} text-white rounded-t-lg`,children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"text-3xl",children:a.icon}),(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{className:"text-lg text-white",children:a.label}),(0,b.jsx)(e.CardDescription,{className:"text-white/90 text-xs",children:a.description})]})]})})}),(0,b.jsx)(e.CardContent,{className:"pt-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:c.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Projects"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:[c.filter(a=>"completed"===a.status).length," Completed"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[c.filter(a=>"in_progress"===a.status).length," In Progress"]})]})]})})]},a.value)})}),(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(p.Search,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"Search projects...",className:"pl-8",value:_,onChange:a=>aa(a.target.value)})]}),(0,b.jsxs)(h.Select,{value:ad,onValueChange:ae,children:[(0,b.jsx)(h.SelectTrigger,{className:"w-full md:w-[200px]",children:(0,b.jsx)(h.SelectValue,{placeholder:"Filter by service"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"All Services"}),(0,b.jsx)(h.SelectItem,{value:"video_production",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[G.SERVICE_TYPES.video_production.icon," Video Production"]})}),(0,b.jsx)(h.SelectItem,{value:"social_media",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[G.SERVICE_TYPES.social_media.icon," Social Media"]})}),(0,b.jsx)(h.SelectItem,{value:"design_branding",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[G.SERVICE_TYPES.design_branding.icon," Design & Branding"]})})]})]}),(0,b.jsxs)(h.Select,{value:ab,onValueChange:ac,children:[(0,b.jsx)(h.SelectTrigger,{className:"w-full md:w-[180px]",children:(0,b.jsx)(h.SelectValue,{placeholder:"Filter by status"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(h.SelectItem,{value:"planning",children:"Planning"}),(0,b.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(h.SelectItem,{value:"in_review",children:"In Review"}),(0,b.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(h.SelectItem,{value:"stuck",children:"Stuck"}),(0,b.jsx)(h.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),Z?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(s.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===P.length?(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(t.FolderKanban,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No projects yet"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Get started by creating your first project"}),(0,b.jsxs)(f.Button,{onClick:()=>ag(!0),disabled:0===R.length,children:[(0,b.jsx)(o.Plus,{className:"mr-2 h-4 w-4"}),"Create First Project"]}),0===R.length&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Add a client first in the Clients page"})]})}):(0,b.jsx)("div",{className:"grid gap-4",children:0===bf.length?(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"flex flex-col items-center justify-center py-12",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No projects match your search"})})}):bf.map(a=>(0,b.jsxs)(e.Card,{role:"button",tabIndex:0,onClick:()=>bh(a),onKeyDown:b=>{("Enter"===b.key||" "===b.key)&&(b.preventDefault(),bh(a))},className:"group relative overflow-hidden cursor-pointer rounded-2xl bg-white/10 dark:bg-white/5 border border-white/20 ring-1 ring-white/10 hover:ring-white/20 hover:bg-white/15 shadow-lg hover:shadow-xl transition-all duration-200 supports-[backdrop-filter]:backdrop-blur-lg hover:-translate-y-0.5",children:[(0,b.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/2 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent"}),(0,b.jsx)(e.CardHeader,{className:"relative z-10",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[a.thumbnail_url&&(0,b.jsx)("div",{className:"w-full md:w-32 h-32 rounded-lg overflow-hidden border bg-muted flex-shrink-0",children:(0,b.jsx)("img",{src:a.thumbnail_url,alt:a.name,className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>bh(a),children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,b.jsx)(e.CardTitle,{children:a.name})}),(0,b.jsx)(e.CardDescription,{className:"mt-1",children:a.clients?.company_name||"No client"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(I.Badge,{variant:bx(a.service_type),children:[(0,b.jsx)("span",{className:"mr-1",children:bk(a.service_type)}),bl(a.service_type)]}),(0,b.jsx)(n.StatusBadge,{status:a.status})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 text-sm",children:[a.created_by&&X[a.created_by]&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(D.UserCheck,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:X[a.created_by].full_name})]}),at[a.id]&&at[a.id].length>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)(y.Users,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsx)("div",{className:"flex gap-1 flex-wrap",children:at[a.id].map(a=>(0,b.jsx)(I.Badge,{variant:"secondary",className:"text-xs",children:a.full_name||a.email.split("@")[0]},a.id))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(B.TrendingUp,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[a.progress_percentage,"% complete"]})]})]})]})]})}),(0,b.jsxs)(e.CardContent,{className:"relative z-10 space-y-3",children:[a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[a.deadline&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(q.Calendar,{className:"h-3 w-3"}),"Deadline"]}),(0,b.jsx)("p",{className:"font-medium",children:new Date(a.deadline).toLocaleDateString()})]}),a.budget&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(r.DollarSign,{className:"h-3 w-3"}),"Budget"]}),(0,b.jsxs)("p",{className:"font-medium",children:["â‚¹",a.budget.toLocaleString()]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1",children:[(0,b.jsx)("span",{children:"Progress"}),(0,b.jsxs)("span",{className:"font-medium",children:[a.progress_percentage,"%"]})]}),(0,b.jsx)(k.Progress,{value:a.progress_percentage,className:"h-1.5"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"secondary",size:"sm",onClick:b=>{b.stopPropagation(),bh(a)},children:[(0,b.jsx)(v.Eye,{className:"h-3 w-3 mr-1"}),"View"]}),(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),ak(a),aF({name:a.name,client_id:a.client_id,description:a.description||"",service_type:a.service_type,budget:a.budget?.toString()||"",start_date:a.start_date||"",deadline:a.deadline||"",status:a.status,progress_percentage:a.progress_percentage}),as(!0)},children:[(0,b.jsx)(w,{className:"h-3 w-3 mr-1"}),"Edit"]}),(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),bi(a)},children:[(0,b.jsx)(y.Users,{className:"h-3 w-3 mr-1"}),"Team"]}),(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),window.location.href=`/dashboard/invoices?project=${a.id}`},children:[(0,b.jsx)(z.FileText,{className:"h-3 w-3 mr-1"}),"Invoice"]})]})]})]},a.id))}),(0,b.jsx)(m.Dialog,{open:al,onOpenChange:am,children:(0,b.jsxs)(m.DialogContent,{className:"max-w-4xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,b.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),aj&&(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.DialogTitle,{className:"text-2xl",children:aj.name}),(0,b.jsxs)(m.DialogDescription,{className:"mt-2",children:["Client: ",aj.clients?.company_name||"No client"]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(I.Badge,{variant:bx(aj.service_type),children:[(0,b.jsx)("span",{className:"mr-1",children:bk(aj.service_type)}),bl(aj.service_type)]}),(0,b.jsx)(n.StatusBadge,{status:aj.status})]})]})}),(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:"Project Overview"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[aj.budget&&(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(r.DollarSign,{className:"h-3 w-3"}),"Budget"]}),(0,b.jsxs)("p",{className:"font-semibold",children:["â‚¹",aj.budget.toLocaleString()]})]}),aj.start_date&&(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(q.Calendar,{className:"h-3 w-3"}),"Start Date"]}),(0,b.jsx)("p",{className:"font-semibold",children:new Date(aj.start_date).toLocaleDateString()})]}),aj.deadline&&(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(C.Clock,{className:"h-3 w-3"}),"Deadline"]}),(0,b.jsx)("p",{className:"font-semibold",children:new Date(aj.deadline).toLocaleDateString()})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(B.TrendingUp,{className:"h-3 w-3"}),"Progress"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Progress,{value:aj.progress_percentage,className:"h-2 flex-1"}),(0,b.jsxs)("span",{className:"font-semibold text-sm",children:[aj.progress_percentage,"%"]})]})]})]})]}),aj.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Description"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:aj.description})]}),aj?.service_type==="social_media"&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,b.jsx)(f.Button,{size:"sm",variant:"default",onClick:()=>bn(!0),children:"Content Calendar"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[(0,b.jsx)(E.ListTodo,{className:"h-4 w-4"}),"Sub-Projects / Tasks"]}),(0,b.jsxs)(f.Button,{size:"sm",variant:"outline",onClick:()=>aL(!0),children:[(0,b.jsx)(o.Plus,{className:"h-3 w-3 mr-1"}),"Add Task"]})]}),aG[aj.id]&&aG[aj.id].length>0?(0,b.jsx)("div",{className:"space-y-2",children:aG[aj.id].map(a=>(0,b.jsx)(e.Card,{className:"hover:border-primary/50 transition-colors",children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h4",{className:"font-medium",children:a.name}),(0,b.jsx)(n.StatusBadge,{status:a.status}),(0,b.jsx)(f.Button,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>{aJ(a),aR({name:a.name,description:a.description||"",assigned_to:a.assigned_to||"unassigned",due_date:a.due_date||"",status:a.status,video_url:a.video_url||""}),aN(!0)},children:(0,b.jsx)(w,{className:"h-3 w-3"})})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),a.video_url&&(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsxs)("a",{href:a.video_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-primary hover:underline",children:[(0,b.jsx)(u.Video,{className:"h-3 w-3"}),"View Video"]})}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-muted-foreground",children:[a.assigned_user&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(D.UserCheck,{className:"h-3 w-3"}),a.assigned_user.full_name||a.assigned_user.email]}),a.due_date&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(q.Calendar,{className:"h-3 w-3"}),new Date(a.due_date).toLocaleDateString()]})]})]}),(0,b.jsxs)(h.Select,{value:a.status,onValueChange:b=>be(a.id,b),children:[(0,b.jsx)(h.SelectTrigger,{className:"w-[130px]",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"planning",children:"Planning"}),(0,b.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(h.SelectItem,{value:"in_review",children:"In Review"}),(0,b.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(h.SelectItem,{value:"stuck",children:"Stuck"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Progress,{value:a.progress_percentage,className:"h-2 flex-1"}),(0,b.jsxs)("span",{className:"text-xs font-medium w-10 text-right",children:[a.progress_percentage,"%"]})]}),(0,b.jsx)(g.Input,{type:"range",min:"0",max:"100",value:a.progress_percentage,onChange:b=>bd(a.id,parseInt(b.target.value)),className:"h-2"})]})]})})},a.id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,b.jsx)(E.ListTodo,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No tasks yet. Break down this project into smaller tasks."]})})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Milestones"}),(0,b.jsxs)(f.Button,{size:"sm",variant:"outline",onClick:()=>ao(!0),children:[(0,b.jsx)(o.Plus,{className:"h-3 w-3 mr-1"}),"Add Milestone"]})]}),V[aj.id]&&V[aj.id].length>0?(0,b.jsx)("div",{className:"space-y-2",children:V[aj.id].map(a=>(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h4",{className:"font-medium",children:a.title}),(0,b.jsx)(n.StatusBadge,{status:a.status})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),a.due_date&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Due: ",new Date(a.due_date).toLocaleDateString()]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(h.Select,{value:a.status,onValueChange:b=>a5(aj.id,a.id,b),children:[(0,b.jsx)(h.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(h.SelectValue,{placeholder:"Status"})}),(0,b.jsx)(h.SelectContent,{children:aD.map(a=>(0,b.jsx)(h.SelectItem,{value:a.value,children:a.label},a.value))})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>a6(aj.id,a.id),title:"Delete milestone",children:(0,b.jsx)(x.Trash2,{className:"h-4 w-4"})})]})]})})},a.id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,b.jsx)(A.CheckSquare,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No milestones yet. Add milestones to track project progress."]})})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Team Members"}),K?.role==="admin"&&(0,b.jsxs)(f.Button,{size:"sm",variant:"outline",onClick:()=>aq(!0),children:[(0,b.jsx)(o.Plus,{className:"h-3 w-3 mr-1"}),"Assign Member"]})]}),at[aj.id]&&at[aj.id].length>0?(0,b.jsx)("div",{className:"space-y-2",children:at[aj.id].map(a=>(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-sm font-medium",children:a.full_name?.charAt(0)||a.email.charAt(0)})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.full_name||a.email}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.role})]})]}),K?.role==="admin"&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>a8(a.id),children:(0,b.jsx)(x.Trash2,{className:"h-4 w-4 text-destructive"})})]})})},a.id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[(0,b.jsx)(y.Users,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No team members assigned yet."]})})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:"Files & Documents"}),(0,b.jsx)(J.FileManager,{projectId:aj.id,driveFolderUrl:aj.drive_folder_url,onDriveFolderUpdate:a=>{ak({...aj,drive_folder_url:a}),Q(b=>b.map(b=>b.id===aj.id?{...b,drive_folder_url:a}:b))}})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>am(!1),children:"Close"}),(0,b.jsxs)(f.Button,{children:[(0,b.jsx)(w,{className:"h-4 w-4 mr-2"}),"Edit Project"]})]})]})]})}),(0,b.jsx)(m.Dialog,{open:bm&&aj?.service_type==="social_media",onOpenChange:bn,children:(0,b.jsxs)(m.DialogContent,{className:"max-w-5xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,b.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),(0,b.jsxs)("div",{className:"relative z-10 space-y-4",children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{className:"text-2xl",children:"Content Calendar"}),(0,b.jsxs)(m.DialogDescription,{children:["Plan and manage content for ",aj?.name||"project"]})]}),(0,b.jsx)(function({events:a,onCreate:d,onUpdate:e,onDelete:g,onOpenDate:h}){let[i,j]=(0,c.useState)(new Date),k=new Date(i.getFullYear(),i.getMonth(),1),l=new Date(i.getFullYear(),i.getMonth()+1,0),m=k.getDay(),n=l.getDate(),o=[],p=Array(m).fill(null);for(let a=1;a<=n;a++){let b=new Date(i.getFullYear(),i.getMonth(),a);p.push(b),7===p.length&&(o.push(p),p=[])}if(p.length){for(;p.length<7;)p.push(null);o.push(p)}let q=new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric"});function r(b){let c=b.toISOString().slice(0,10);return a.filter(a=>(a.date||"").slice(0,10)===c)}return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-xl font-semibold",children:q.format(i)}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>j(new Date(i.getFullYear(),i.getMonth()-1,1)),children:"Prev"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>j(new Date),children:"Today"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>j(new Date(i.getFullYear(),i.getMonth()+1,1)),children:"Next"})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-7 gap-2 text-xs text-muted-foreground",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>(0,b.jsx)("div",{className:"px-2 py-1",children:a},a))}),(0,b.jsx)("div",{className:"grid grid-cols-7 gap-2",children:o.map((a,c)=>(0,b.jsx)("div",{className:"contents",children:a.map((a,c)=>(0,b.jsx)("div",{className:"rounded-lg border p-2 min-h-[110px] bg-white/5 hover:bg-white/10 transition-colors",children:a?(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-xs font-medium",children:a.getDate()}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>d(a),children:"+ Add"}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>h(a,r(a)),children:"Open"})]})]}),(0,b.jsx)("div",{className:"space-y-2",children:r(a).map(a=>(0,b.jsxs)("div",{className:"rounded-md border p-2 bg-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-medium truncate",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>g(a.id),children:"Del"}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>e({...a,status:"published"===a.status?"scheduled":"published"}),children:"published"===a.status?"Unpublish":"Publish"}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>{let b=prompt("Paste image/video URL");if(!b)return;let c=b.match(/\.(png|jpg|jpeg|gif|webp)$/i)?"image":b.match(/\.(mp4|webm|mov)$/i)?"video":b.match(/\.(pdf)$/i)?"pdf":"document",d={id:Math.random().toString(36).slice(2),url:b,kind:c};e({...a,attachments:[...a.attachments||[],d]})},children:"Add Media"})]})]}),a.copy&&(0,b.jsx)("div",{className:"mt-1 text-[11px] text-muted-foreground line-clamp-3 whitespace-pre-wrap",children:a.copy}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[a.platform&&(0,b.jsx)(I.Badge,{variant:"outline",className:"text-[10px]",children:a.platform}),a.type&&(0,b.jsx)(I.Badge,{variant:"outline",className:"text-[10px]",children:a.type}),a.status&&(0,b.jsx)(I.Badge,{variant:"outline",className:"text-[10px]",children:a.status})]}),a.attachments&&a.attachments.length>0&&(0,b.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:a.attachments.map(a=>(0,b.jsxs)("div",{className:"rounded-md overflow-hidden border bg-black/20",children:["image"===a.kind&&(0,b.jsx)("img",{src:a.url,alt:"attachment",className:"w-full h-20 object-cover"}),"video"===a.kind&&(0,b.jsx)("video",{src:a.url,className:"w-full h-20 object-cover",controls:!0,preload:"metadata"}),"image"!==a.kind&&"video"!==a.kind&&(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs p-2 inline-block w-full truncate",children:a.url})]},a.id))})]},a.id))})]}):null},c))},c))})]})},{events:bs,onCreate:a=>bu(a),onUpdate:a=>bv(a),onDelete:a=>bw(a),onOpenDate:(a,b)=>{br({date:a,events:b}),bp(!0)}})]})]})}),(0,b.jsx)(m.Dialog,{open:bo,onOpenChange:bp,children:(0,b.jsxs)(m.DialogContent,{className:"max-w-3xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,b.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),(0,b.jsxs)("div",{className:"relative z-10 space-y-4",children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{className:"text-2xl",children:bq?new Date(bq.date).toLocaleDateString():"Date"}),(0,b.jsx)(m.DialogDescription,{children:"Detailed content planning"})]}),(0,b.jsx)(function({onAdd:d}){let[i,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)("instagram"),[p,q]=(0,c.useState)("reel"),[r,s]=(0,c.useState)("idea"),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)([]);async function z(b){let c=b.target.files?.[0];if(c){w(!0);try{let{validateFileSize:b,getFileType:d}=await a.A(52439),e=b(c);if(!e.valid)return void alert(e.error);let f=d(c.name),{createClient:g}=await a.A(96384),h=g(),i=`content/${Date.now()}_${c.name}`,{error:j}=await h.storage.from("project-files").upload(i,c,{cacheControl:"3600",upsert:!1});if(j)throw Error(j.message);let{data:k}=h.storage.from("project-files").getPublicUrl(i),l={id:Math.random().toString(36).slice(2),url:k.publicUrl,kind:"other"===f?"document":f};y(a=>[...a||[],l])}catch(a){console.error("Upload failed",a),alert(a.message||"Upload failed")}finally{w(!1),b.target.value=""}}}return(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Title"}),(0,b.jsx)(g.Input,{value:i,onChange:a=>k(a.target.value),placeholder:"Content title"})]}),(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Copy / Caption"}),(0,b.jsx)(j.Textarea,{value:l,onChange:a=>m(a.target.value),placeholder:"Write caption, brief, or notes",rows:4})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Platform"}),(0,b.jsxs)(h.Select,{value:n,onValueChange:a=>o(a),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"instagram",children:"Instagram"}),(0,b.jsx)(h.SelectItem,{value:"facebook",children:"Facebook"}),(0,b.jsx)(h.SelectItem,{value:"youtube",children:"YouTube"}),(0,b.jsx)(h.SelectItem,{value:"linkedin",children:"LinkedIn"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Type"}),(0,b.jsxs)(h.Select,{value:p,onValueChange:a=>q(a),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"reel",children:"Reel"}),(0,b.jsx)(h.SelectItem,{value:"carousel",children:"Carousel"}),(0,b.jsx)(h.SelectItem,{value:"story",children:"Story"}),(0,b.jsx)(h.SelectItem,{value:"static",children:"Static"}),(0,b.jsx)(h.SelectItem,{value:"video",children:"Video"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Status"}),(0,b.jsxs)(h.Select,{value:r,onValueChange:a=>s(a),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"idea",children:"Idea"}),(0,b.jsx)(h.SelectItem,{value:"editing",children:"Editing"}),(0,b.jsx)(h.SelectItem,{value:"review",children:"Ready for review"}),(0,b.jsx)(h.SelectItem,{value:"scheduled",children:"Scheduled"}),(0,b.jsx)(h.SelectItem,{value:"published",children:"Published"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Attachment URL (optional)"}),(0,b.jsx)(g.Input,{value:t,onChange:a=>u(a.target.value),placeholder:"https://..."}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"file",onChange:z,accept:"image/*,video/*,.pdf,.doc,.docx,.txt"}),v&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Uploadingâ€¦"})]}),x&&x.length>0&&(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:x.map(a=>(0,b.jsxs)("div",{className:"rounded-md overflow-hidden border bg-black/20",children:["image"===a.kind&&(0,b.jsx)("img",{src:a.url,alt:"attachment",className:"w-full h-20 object-cover"}),"video"===a.kind&&(0,b.jsx)("video",{src:a.url,className:"w-full h-20 object-cover",controls:!0,preload:"metadata"}),"image"!==a.kind&&"video"!==a.kind&&(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs p-2 inline-block w-full truncate",children:a.url})]},a.id))})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(f.Button,{onClick:()=>{i.trim()&&(d({title:i,copy:l,platform:n,type:p,status:r,attachments:[...x||[],...function(a){if(!a)return;let b=a.match(/\.(png|jpg|jpeg|gif|webp)$/i)?"image":a.match(/\.(mp4|webm|mov)$/i)?"video":a.match(/\.(pdf)$/i)?"pdf":"document";return[{id:Math.random().toString(36).slice(2),url:a,kind:b}]}(t)||[]]}),k(""),m(""),u(""),y([]))},children:"Add to Calendar"})})]})})},{onAdd:a=>{let b=bq?.date||new Date,c={id:Math.random().toString(36).slice(2),date:new Date(b.getFullYear(),b.getMonth(),b.getDate()).toISOString(),title:a.title,platform:a.platform,type:a.type,status:a.status,attachments:a.attachments||[]};bt(a=>[...a,c])}}),(0,b.jsx)("div",{className:"space-y-3",children:0===(bq?.events||[]).length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No content entries for this day"}):(bq?.events||[]).map(a=>(0,b.jsxs)("div",{className:"rounded-md border p-3 bg-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.title}),a.platform&&(0,b.jsx)(I.Badge,{variant:"outline",className:"text-[10px]",children:a.platform}),a.type&&(0,b.jsx)(I.Badge,{variant:"outline",className:"text-[10px]",children:a.type}),a.status&&(0,b.jsx)(I.Badge,{variant:"outline",className:"text-[10px]",children:a.status})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>bw(a.id),children:"Delete"}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>bv({...a,status:"published"===a.status?"scheduled":"published"}),children:"published"===a.status?"Unpublish":"Publish"})]})]}),a.copy&&(0,b.jsx)("div",{className:"mt-2 text-sm text-muted-foreground whitespace-pre-wrap",children:a.copy}),a.attachments&&a.attachments.length>0&&(0,b.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:a.attachments.map(a=>(0,b.jsxs)("div",{className:"rounded-md overflow-hidden border bg-black/20",children:["image"===a.kind&&(0,b.jsx)("img",{src:a.url,alt:"attachment",className:"w-full h-24 object-cover"}),"video"===a.kind&&(0,b.jsx)("video",{src:a.url,className:"w-full h-24 object-cover",controls:!0,preload:"metadata"}),"image"!==a.kind&&"video"!==a.kind&&(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs p-2 inline-block w-full truncate",children:a.url})]},a.id))})]},a.id))})]})]})}),(0,b.jsx)(m.Dialog,{open:an,onOpenChange:ao,children:(0,b.jsx)(m.DialogContent,{children:(0,b.jsxs)("form",{onSubmit:a4,children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Add Milestone"}),(0,b.jsxs)(m.DialogDescription,{children:["Create a new milestone for ",aj?.name]})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"milestone-title",children:"Title *"}),(0,b.jsx)(g.Input,{id:"milestone-title",placeholder:"Script completion",required:!0,value:aB.title,onChange:a=>aC({...aB,title:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"milestone-desc",children:"Description"}),(0,b.jsx)(j.Textarea,{id:"milestone-desc",placeholder:"Complete final draft of script",value:aB.description,onChange:a=>aC({...aB,description:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"milestone-date",children:"Due Date"}),(0,b.jsx)(g.Input,{id:"milestone-date",type:"date",value:aB.due_date,onChange:a=>aC({...aB,due_date:a.target.value})})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>ao(!1),disabled:ah,children:"Cancel"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:ah,children:[ah&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Milestone"]})]})]})})}),K?.role==="admin"&&(0,b.jsx)(m.Dialog,{open:ap,onOpenChange:aq,children:(0,b.jsxs)(m.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.DialogTitle,{children:"Team Members"}),(0,b.jsxs)(m.DialogDescription,{children:["Manage team members for ",aj?.name]})]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>aj&&a9(aj.id),className:"gap-2",children:[(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),(0,b.jsx)("path",{d:"M21 3v5h-5"})]}),"Refresh"]})]})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[!1,at[aj?.id||""]&&at[aj?.id||""].length>0&&(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3 p-4 bg-muted/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:at[aj?.id||""].length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Team Members"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:at[aj?.id||""].filter(a=>"admin"===a.role).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Admins"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:at[aj?.id||""].filter(a=>"project_manager"===a.role).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"PMs"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-semibold mb-3",children:["Current Team Members (",at[aj?.id||""]?.length||0,")"]}),at[aj?.id||""]&&at[aj?.id||""].length>0?(0,b.jsx)("div",{className:"space-y-2",children:at[aj?.id||""].map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:border-primary/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)("span",{className:"text-sm font-semibold text-primary",children:a.full_name?.charAt(0)||a.email.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-medium truncate",children:a.full_name||a.email}),(0,b.jsx)(I.Badge,{variant:"admin"===a.role?"default":"secondary",className:"text-[10px] px-1.5 py-0",children:"admin"===a.role?"Admin":"PM"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:a.email})]})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>a8(a.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:(0,b.jsx)(x.Trash2,{className:"h-4 w-4"})})]},a.id))}):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground text-sm border rounded-lg",children:[(0,b.jsx)(y.Users,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No team members assigned yet"]})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:"Add Team Member"}),(0,b.jsxs)("form",{onSubmit:a7,children:[(0,b.jsxs)("div",{className:"grid gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"team-member",children:"Team Member *"}),(0,b.jsxs)(h.Select,{value:ax,onValueChange:ay,required:!0,children:[(0,b.jsx)(h.SelectTrigger,{id:"team-member",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select a team member"})}),(0,b.jsx)(h.SelectContent,{children:0===av.length?(0,b.jsx)(h.SelectItem,{value:"none",disabled:!0,children:"No users available"}):av.filter(a=>!at[aj?.id||""]?.find(b=>b.id===a.id)).map(a=>(0,b.jsxs)(h.SelectItem,{value:a.id,children:[a.full_name," (",a.email,")"]},a.id))})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"team-role",children:"Role (Optional)"}),(0,b.jsx)(g.Input,{id:"team-role",placeholder:"e.g., Lead Editor, Designer",value:az,onChange:a=>aA(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>aq(!1),disabled:ah,children:"Close"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:ah||!ax,children:[ah&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Assign Member"]})]})]})]})]})]})}),(0,b.jsx)(m.Dialog,{open:ar,onOpenChange:as,children:(0,b.jsx)(m.DialogContent,{className:"max-w-md md:max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,b.jsxs)("form",{onSubmit:bj,children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Edit Project"}),(0,b.jsx)(m.DialogDescription,{children:"Update project details"})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-name",children:"Project Name *"}),(0,b.jsx)(g.Input,{id:"edit-name",required:!0,value:aE.name,onChange:a=>aF({...aE,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-client",children:"Client *"}),(0,b.jsxs)(h.Select,{value:aE.client_id,onValueChange:a=>aF({...aE,client_id:a}),required:!0,children:[(0,b.jsx)(h.SelectTrigger,{id:"edit-client",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select a client"})}),(0,b.jsx)(h.SelectContent,{children:R.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.company_name},a.id))})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-description",children:"Description"}),(0,b.jsx)(j.Textarea,{id:"edit-description",placeholder:"Project description",value:aE.description,onChange:a=>aF({...aE,description:a.target.value}),rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-service",children:"Service Type *"}),(0,b.jsxs)(h.Select,{value:aE.service_type,onValueChange:a=>aF({...aE,service_type:a}),required:!0,children:[(0,b.jsx)(h.SelectTrigger,{id:"edit-service",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{children:G.SERVICE_TYPE_OPTIONS.map(a=>(0,b.jsxs)(h.SelectItem,{value:a.value,children:[(0,b.jsx)("span",{className:"mr-2",children:a.icon}),a.label]},a.value))})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-status",children:"Status *"}),(0,b.jsxs)(h.Select,{value:aE.status,onValueChange:a=>aF({...aE,status:a}),required:!0,children:[(0,b.jsx)(h.SelectTrigger,{id:"edit-status",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"planning",children:"Planning"}),(0,b.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(h.SelectItem,{value:"in_review",children:"In Review"}),(0,b.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(h.SelectItem,{value:"stuck",children:"Stuck"}),(0,b.jsx)(h.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-budget",children:"Budget (â‚¹)"}),(0,b.jsx)(g.Input,{id:"edit-budget",type:"number",placeholder:"100000",value:aE.budget,onChange:a=>aF({...aE,budget:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-progress",children:"Progress (%)"}),(0,b.jsx)(g.Input,{id:"edit-progress",type:"number",min:"0",max:"100",value:aE.progress_percentage,onChange:a=>aF({...aE,progress_percentage:parseInt(a.target.value)||0})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-start",children:"Start Date"}),(0,b.jsx)(g.Input,{id:"edit-start",type:"date",value:aE.start_date,onChange:a=>aF({...aE,start_date:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-deadline",children:"Deadline"}),(0,b.jsx)(g.Input,{id:"edit-deadline",type:"date",value:aE.deadline,onChange:a=>aF({...aE,deadline:a.target.value})})]})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>as(!1),disabled:ah,children:"Cancel"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:ah,children:[ah&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})})}),(0,b.jsx)(m.Dialog,{open:aK,onOpenChange:a=>{a||aP({name:"",description:"",assigned_to:"unassigned",due_date:"",status:"planning",video_url:""}),aL(a)},children:(0,b.jsx)(m.DialogContent,{children:(0,b.jsxs)("form",{onSubmit:bb,children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Add Sub-Project / Task"}),(0,b.jsxs)(m.DialogDescription,{children:["Create a task for ",aj?.name]})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"sub-project-name",children:"Task Name *"}),(0,b.jsx)(g.Input,{id:"sub-project-name",placeholder:"e.g., Script Writing, Video Editing",required:!0,value:aO.name,onChange:a=>aP({...aO,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"sub-project-desc",children:"Description"}),(0,b.jsx)(j.Textarea,{id:"sub-project-desc",placeholder:"Task details...",value:aO.description,onChange:a=>aP({...aO,description:a.target.value}),rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"sub-project-assign",children:"Assign To"}),(0,b.jsxs)(h.Select,{value:aO.assigned_to,onValueChange:a=>aP({...aO,assigned_to:a}),children:[(0,b.jsx)(h.SelectTrigger,{id:"sub-project-assign",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select team member"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"unassigned",children:"Unassigned"}),av.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.full_name||a.email},a.id))]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"sub-project-status",children:"Status"}),(0,b.jsxs)(h.Select,{value:aO.status,onValueChange:a=>aP({...aO,status:a}),children:[(0,b.jsx)(h.SelectTrigger,{id:"sub-project-status",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"planning",children:"Planning"}),(0,b.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(h.SelectItem,{value:"in_review",children:"In Review"}),(0,b.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(h.SelectItem,{value:"stuck",children:"Stuck"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"sub-project-date",children:"Due Date"}),(0,b.jsx)(g.Input,{id:"sub-project-date",type:"date",value:aO.due_date,onChange:a=>aP({...aO,due_date:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"sub-project-video",children:"Video URL (Optional)"}),(0,b.jsx)(g.Input,{id:"sub-project-video",type:"url",placeholder:"https://youtube.com/watch?v=... or https://drive.google.com/...",value:aO.video_url,onChange:a=>aP({...aO,video_url:a.target.value})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add a YouTube, Google Drive, or other video link"})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>aL(!1),disabled:ah,children:"Cancel"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:ah||!aO.name.trim(),children:[ah&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),ah?"Creating Task...":"Add Task"]})]})]})})}),(0,b.jsx)(m.Dialog,{open:aM,onOpenChange:aN,children:(0,b.jsx)(m.DialogContent,{className:"max-w-2xl",children:(0,b.jsxs)("form",{onSubmit:bc,children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Edit Task"}),(0,b.jsx)(m.DialogDescription,{children:"Update task details for this project"})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-sub-project-name",children:"Task Name *"}),(0,b.jsx)(g.Input,{id:"edit-sub-project-name",value:aQ.name,onChange:a=>aR({...aQ,name:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-sub-project-description",children:"Description"}),(0,b.jsx)(j.Textarea,{id:"edit-sub-project-description",value:aQ.description,onChange:a=>aR({...aQ,description:a.target.value}),rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-sub-project-assigned",children:"Assigned To"}),(0,b.jsxs)(h.Select,{value:aQ.assigned_to,onValueChange:a=>aR({...aQ,assigned_to:a}),children:[(0,b.jsx)(h.SelectTrigger,{id:"edit-sub-project-assigned",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"unassigned",children:"Unassigned"}),av.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.full_name||a.email},a.id))]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-sub-project-status",children:"Status"}),(0,b.jsxs)(h.Select,{value:aQ.status,onValueChange:a=>aR({...aQ,status:a}),children:[(0,b.jsx)(h.SelectTrigger,{id:"edit-sub-project-status",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"planning",children:"Planning"}),(0,b.jsx)(h.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(h.SelectItem,{value:"in_review",children:"In Review"}),(0,b.jsx)(h.SelectItem,{value:"completed",children:"Completed"}),(0,b.jsx)(h.SelectItem,{value:"stuck",children:"Stuck"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-sub-project-date",children:"Due Date"}),(0,b.jsx)(g.Input,{id:"edit-sub-project-date",type:"date",value:aQ.due_date,onChange:a=>aR({...aQ,due_date:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(i.Label,{htmlFor:"edit-sub-project-video",children:"Video URL (Optional)"}),(0,b.jsx)(g.Input,{id:"edit-sub-project-video",type:"url",placeholder:"https://youtube.com/watch?v=... or https://drive.google.com/...",value:aQ.video_url,onChange:a=>aR({...aQ,video_url:a.target.value})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add a YouTube, Google Drive, or other video link"})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>{aN(!1),aJ(null)},disabled:ah,children:"Cancel"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:ah,children:[ah&&(0,b.jsx)(s.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Task"]})]})]})})})]})}function P(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(s.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,b.jsx)(O,{})})}a.s(["default",()=>P],94229)}];

//# sourceMappingURL=app_dashboard_projects_page_tsx_760b1698._.js.map