module.exports=[20731,a=>{"use strict";var b=a.i(87924),c=a.i(38422),d=a.i(50944),e=a.i(72131),f=a.i(35114),g=a.i(3130),h=a.i(40695),i=a.i(65733),j=a.i(2150),k=a.i(90166),l=a.i(63416),m=a.i(4720),n=a.i(15618),o=a.i(41675),p=a.i(60246),q=a.i(24669),r=a.i(92e3),s=a.i(67453);let t=(0,a.i(70106).default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var u=a.i(23312),v=a.i(41710),w=a.i(39786),x=a.i(69240),y=a.i(54161),z=a.i(21958),A=a.i(87682),B=a.i(5522),C=a.i(52813),D=a.i(5050),E=(0,D.createServerReference)("40e9debad081e2ea61fef36767d769afdc486d2864",D.callServer,void 0,D.findSourceMapURL,"reviewProjectProposal"),F=(0,D.createServerReference)("407d00f69ec1463aaf4cba7dfeb078331c034b7beb",D.callServer,void 0,D.findSourceMapURL,"approveUserAccount"),G=(0,D.createServerReference)("40562833b8610881280abfc4553d749f1e50b42e3d",D.callServer,void 0,D.findSourceMapURL,"grantAdminByEmail"),H=a.i(57523);function I(){let a,D,I,J,K,L,M,N,O,P,Q,{user:R,loading:S}=(0,c.useAuth)(),T=(0,d.useRouter)(),[U,V]=(0,e.useState)([]),[W,X]=(0,e.useState)([]),[Y,Z]=(0,e.useState)([]),[$,_]=(0,e.useState)([]),[aa,ab]=(0,e.useState)([]),[ac,ad]=(0,e.useState)({}),[ae,af]=(0,e.useState)(!1),[ag,ah]=(0,e.useState)(!1),[ai,aj]=(0,e.useState)(!0),[ak,al]=(0,e.useState)(null),[am,an]=(0,e.useState)("all"),[ao,ap]=(0,e.useState)(null),[aq,ar]=(0,e.useState)([]),[as,at]=(0,e.useState)(!1),[au,av]=(0,e.useState)(null),[aw,ax]=(0,e.useState)(!1),[ay,az]=(0,e.useState)(""),[aA,aB]=(0,e.useState)(!1),[aC,aD]=(0,e.useState)(""),[aE,aF]=(0,e.useState)(!1),[aG,aH]=(0,e.useState)(""),[aI,aJ]=(0,e.useState)(!1),[aK,aL]=(0,e.useState)({totalRevenue:0,activeProjects:0,pendingInvoices:0,totalClients:0,overdueInvoices:0,completedProjects:0,avgProjectValue:0}),[aM,aN]=(0,e.useState)([]);(0,e.useEffect)(()=>{!async function(){if(!R||S)return;al(null),aj(!0);let a=(0,x.createClient)();try{let{data:b,error:c}=await a.from("projects").select("*, clients(company_name)").order("created_at",{ascending:!1});if(c)return void al("Unable to load projects right now. Please retry.");let{data:d,error:e}=await a.from("invoices").select("*, clients(company_name)").order("created_at",{ascending:!1});if(e)return void al("Unable to load invoices right now. Please retry.");let{data:f,error:g}=await a.from("clients").select("*").order("created_at",{ascending:!1});if(g)return void al("Unable to load clients right now. Please retry.");let{data:h,error:i}=await a.from("milestones").select("*, projects(name)").in("status",["pending","in_progress"]).order("due_date",{ascending:!0}).limit(5);if(i)return void al("Unable to load milestones right now. Please retry.");V(b||[]),X(d||[]),Z(f||[]),_(h||[]);let j=d?.filter(a=>"paid"===a.status)?.reduce((a,b)=>a+(b.total||0),0)||0,k=b?.filter(a=>"in_progress"===a.status).length||0,l=d?.filter(a=>"pending"===a.status)?.reduce((a,b)=>a+(b.total||0),0)||0,m=f?.length||0,n=b?.filter(a=>"completed"===a.status).length||0,o=new Date,p=d?.filter(a=>"pending"===a.status&&a.due_date&&new Date(a.due_date)<o).length||0,q=b?.reduce((a,b)=>a+(b.budget||0),0)||0,r=b&&b.length>0?q/b.length:0,s=b?.reduce((a,b)=>(a[b.service_type]=(a[b.service_type]||0)+1,a),{})||{},t=Object.values(s).reduce((a,b)=>a+b,0),u=Object.entries(s).map(([a,b])=>({service_type:a,count:b,percentage:t>0?b/t*100:0}));aN(u),aL({totalRevenue:j,activeProjects:k,pendingInvoices:l,totalClients:m,overdueInvoices:p,completedProjects:n,avgProjectValue:r}),af(!0);let{data:v,error:w}=await a.from("employee_tasks").select("id, title, proposed_project_name, proposed_project_status, proposed_project_notes, user_id, created_at, projects(name), users:users!employee_tasks_user_id_fkey(full_name, email)").not("proposed_project_name","is",null).eq("proposed_project_status","pending").order("created_at",{ascending:!1});w||ab(v||[]),af(!1),at(!0);let{data:x,error:y}=await a.from("users").select("id, email, full_name, role, company_name, created_at, status").eq("status","pending").order("created_at",{ascending:!0});y||ar(x||[]),at(!1)}catch(a){console.error("Error fetching dashboard data:",a),al("Something went wrong while loading your dashboard. Please refresh.")}finally{aj(!1)}}()},[R?.id,S]);let aO=(a,b="created_at")=>{let c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate());return a.filter(a=>{if("all"===am)return!0;let e=a[b]?new Date(a[b]):null;if(!e)return!1;let f=new Date(e.getFullYear(),e.getMonth(),e.getDate());switch(am){case"day":return f.getTime()===d.getTime();case"week":{let a=new Date(d);return a.setDate(a.getDate()-7),f>=a&&f<=d}case"month":return e.getMonth()===c.getMonth()&&e.getFullYear()===c.getFullYear();case"quarter":{let a=Math.floor(c.getMonth()/3);return Math.floor(e.getMonth()/3)===a&&e.getFullYear()===c.getFullYear()}case"year":return e.getFullYear()===c.getFullYear();default:return!0}})},aP=(a=aO(U),I=(D=aO(W)).filter(a=>"paid"===a.status).reduce((a,b)=>a+(b.total||0),0)||0,J=a.filter(a=>"in_progress"===a.status).length||0,K=D.filter(a=>"pending"===a.status).reduce((a,b)=>a+(b.total||0),0)||0,L=a.filter(a=>"completed"===a.status).length||0,M=new Date,N=D.filter(a=>"pending"===a.status&&a.due_date&&new Date(a.due_date)<M).length||0,O=a.reduce((a,b)=>a+(b.budget||0),0)||0,P=a.length>0?O/a.length:0,{totalRevenue:I,activeProjects:J,pendingInvoices:K,totalClients:Y.length,overdueInvoices:N,completedProjects:L,avgProjectValue:P}),aQ=async(a,b)=>{av(a);let c=await F({userId:a,decision:b});c.success?ar(b=>b.filter(b=>b.id!==a)):(console.error("Failed to update user status",c.error),al(c.error||"Could not update user status. Please retry.")),av(null)},aR=async(a,b)=>{ah(!0);let c=ac[a],d=await E({taskId:a,decision:b,projectId:c&&"none"!==c?c:void 0});if(d.error)alert(d.error);else{let a=(0,x.createClient)(),{data:b}=await a.from("employee_tasks").select("id, title, proposed_project_name, proposed_project_status, proposed_project_notes, user_id, created_at, projects(name), users:users!employee_tasks_user_id_fkey(full_name, email)").not("proposed_project_name","is",null).eq("proposed_project_status","pending").order("created_at",{ascending:!1});ab(b||[])}ah(!1)},aS=async()=>{if(aC){aF(!0);try{let a=(0,x.createClient)(),b=await (0,H.forceConfirmEmail)(aC);if(!b.success){al(b.error||"Failed to confirm email"),aF(!1);return}let{data:c}=await a.from("users").select("id, email, status").eq("email",aC).limit(1).single();if(!c?.id){al("User not found in users table"),aF(!1);return}let d=await F({userId:c.id,decision:"approved"});if(!d.success){al(d.error||"Failed to approve user"),aF(!1);return}ar(a=>a.filter(a=>a.email!==aC)),aD(""),al(null)}catch(a){al(a?.message||"Unexpected error while confirming & approving")}finally{aF(!1)}}};if(S||ai)return(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})});if(ak)return(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsxs)(g.Card,{className:"max-w-lg w-full",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Dashboard unavailable"}),(0,b.jsx)(g.CardDescription,{children:ak})]}),(0,b.jsxs)(g.CardContent,{className:"flex gap-2",children:[(0,b.jsx)(h.Button,{onClick:()=>T.refresh(),children:"Retry"}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>window.location.reload(),children:"Hard reload"})]})]})});U.slice(0,5);let aT=W.slice(0,5),aU=Y.slice(0,5);return(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:gap-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight select-none",onDoubleClick:()=>ax(!0),title:"",children:"Dashboard"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-muted-foreground mt-1",children:"Welcome back! Here's an overview of your business."})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsxs)(h.Button,{onClick:()=>T.push("/dashboard/projects"),className:"w-full sm:w-auto",children:[(0,b.jsx)(n.Plus,{className:"h-4 w-4 mr-2"}),"New Project"]}),(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>T.push("/dashboard/clients"),className:"w-full sm:w-auto",children:[(0,b.jsx)(p.Users,{className:"h-4 w-4 mr-2"}),"Add Client"]}),(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>T.push("/dashboard/invoices"),className:"w-full sm:w-auto",children:[(0,b.jsx)(m.FileText,{className:"h-4 w-4 mr-2"}),"Create Invoice"]})]})]}),(0,b.jsx)(i.Dialog,{open:aw,onOpenChange:ax,children:(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsx)(i.DialogTitle,{children:"Admin Tools"}),(0,b.jsx)(i.DialogDescription,{children:"Grant admin or confirm email for a user"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"grant-admin-email",className:"text-sm",children:"Grant Admin by Email"}),(0,b.jsx)(B.Input,{id:"grant-admin-email",value:ay,onChange:a=>az(a.target.value),placeholder:"user@example.com",type:"email"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(h.Button,{disabled:aA||!ay,onClick:async()=>{aB(!0);let a=await G(ay);a.success?(al(null),az("")):al(a.error||"Failed to grant admin"),aB(!1)},children:aA?"Grantingâ€¦":"Grant Admin"})}),(0,b.jsxs)("div",{className:"space-y-2 pt-3 border-t",children:[(0,b.jsx)("label",{htmlFor:"confirm-email",className:"text-sm",children:"Force Confirm Email"}),(0,b.jsx)(B.Input,{id:"confirm-email",value:aG,onChange:a=>aH(a.target.value),placeholder:"client@example.com",type:"email"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Button,{variant:"secondary",disabled:aI||!aG,onClick:async()=>{aJ(!0);let a=await (0,H.forceConfirmEmail)(aG);a.success?(al(null),aH("")):al(a.error||"Failed to confirm email"),aJ(!1)},children:aI?"Confirmingâ€¦":"Confirm Email"}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>ax(!1),children:"Close"})]}),ak&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:ak}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Hint: double-click the â€œDashboardâ€ title to open this."})]})]})}),(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:[{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Quarter",value:"quarter"},{label:"Year",value:"year"},{label:"All",value:"all"}].map(a=>(0,b.jsx)(h.Button,{variant:am===a.value?"default":"outline",size:"sm",onClick:()=>an(a.value),children:a.label},a.value))}),(0,b.jsxs)(g.Card,{className:"border-yellow-300 bg-yellow-50 dark:bg-yellow-900/20",children:[(0,b.jsxs)(g.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm md:text-base",children:"Unconfirmed accounts"}),(0,b.jsx)(g.CardDescription,{className:"text-xs md:text-sm",children:"Some legacy signups may still require email confirmation. Quickly confirm and approve a client by email."})]}),(0,b.jsxs)(g.CardContent,{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsx)(B.Input,{placeholder:"client@example.com",type:"email",value:aC,onChange:a=>aD(a.target.value),className:"sm:max-w-xs"}),(0,b.jsx)(h.Button,{onClick:aS,disabled:aE||!aC,children:aE?"Processingâ€¦":"Confirm + Approve"})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 auto-rows-max",children:[(0,b.jsx)(f.StatCard,{title:"Total Revenue",value:`â‚¹${aP.totalRevenue.toLocaleString()}`,change:"From paid invoices",trend:"up",icon:k.DollarSign}),(0,b.jsx)(f.StatCard,{title:"Active Projects",value:aP.activeProjects.toString(),change:`${aP.completedProjects} completed`,trend:"up",icon:l.FolderKanban}),(0,b.jsx)(f.StatCard,{title:"Total Clients",value:aP.totalClients.toString(),change:"Client relationships",trend:"up",icon:p.Users}),(0,b.jsx)(g.Card,{className:"p-6 sm:row-span-2 lg:col-span-1",children:(0,b.jsxs)("div",{className:"space-y-2 h-full flex flex-col justify-center",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Project Amount"}),(0,b.jsxs)("p",{className:"text-3xl font-bold",children:["â‚¹",Math.round(aO(U).reduce((a,b)=>a+(b.budget||0),0)/1e3),"k"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"all"===am?"All time":`This ${am}`})]})}),(0,b.jsx)(f.StatCard,{title:"Pending Invoices",value:`â‚¹${aP.pendingInvoices.toLocaleString()}`,change:`${aP.overdueInvoices} overdue`,trend:aP.overdueInvoices>0?"down":"neutral",icon:t}),(0,b.jsx)(f.StatCard,{title:"Avg Project Value",value:`â‚¹${Math.round(aP.avgProjectValue).toLocaleString()}`,change:"Per project",trend:"up",icon:q.TrendingUp}),(0,b.jsx)(f.StatCard,{title:"Completion Rate",value:`${aO(U).length>0?Math.round(aP.completedProjects/aO(U).length*100):0}%`,change:`${aP.completedProjects}/${aO(U).length} projects`,trend:"up",icon:s.CheckCircle2}),(0,b.jsx)(f.StatCard,{title:"Pending Approvals",value:aq.length.toString(),change:"Awaiting admin review",trend:"neutral",icon:u.Bell})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:"text-lg md:text-xl",children:"Account Approvals"}),(0,b.jsx)(g.CardDescription,{className:"text-xs md:text-sm",children:"Approve or reject newly registered users"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(y.Badge,{variant:"outline",className:"flex items-center gap-1",children:[(0,b.jsx)(v.Clock,{className:"h-4 w-4"}),aq.length," pending"]}),as&&(0,b.jsx)(y.Badge,{variant:"secondary",children:"Loading..."})]})]}),(0,b.jsx)(g.CardContent,{className:"space-y-3",children:as?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading pending users..."}):0===aq.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No pending accounts right now."}):aq.map(a=>(0,b.jsxs)("div",{className:"p-3 border rounded-lg flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"font-semibold",children:a.full_name||a.email}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.email}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(y.Badge,{variant:"secondary",children:a.role}),a.company_name&&(0,b.jsx)("span",{children:a.company_name}),a.created_at&&(0,b.jsxs)("span",{children:["Joined ",new Date(a.created_at).toLocaleDateString()]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)(h.Button,{size:"sm",variant:"default",disabled:au===a.id,onClick:()=>aQ(a.id,"approved"),children:"Approve"}),"client"===a.role&&(0,b.jsx)(h.Button,{size:"sm",variant:"secondary",disabled:au===a.id,onClick:async()=>{av(a.id);let b=await (0,H.forceConfirmEmail)(a.email);b.success?al(null):al(b.error||"Failed to confirm email"),av(null)},children:"Confirm Email"}),(0,b.jsx)(h.Button,{size:"sm",variant:"outline",disabled:au===a.id,onClick:()=>aQ(a.id,"rejected"),children:"Reject"})]})]},a.id))})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:"text-lg md:text-xl",children:"Project Proposals from Employees"}),(0,b.jsx)(g.CardDescription,{className:"text-xs md:text-sm",children:"Approve or reject tasks that propose new projects"})]}),ae&&(0,b.jsx)(y.Badge,{variant:"outline",children:"Loading..."})]}),(0,b.jsx)(g.CardContent,{children:0===aa.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No pending proposals right now."}):(0,b.jsx)("div",{className:"space-y-3",children:aa.map(a=>(0,b.jsxs)("div",{className:"p-3 border rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("p",{className:"font-semibold",children:a.proposed_project_name}),a.proposed_project_vertical&&(0,b.jsxs)(y.Badge,{variant:"secondary",className:"text-xs",children:["video_production"===a.proposed_project_vertical&&"ğŸ¬ Video Production","social_media"===a.proposed_project_vertical&&"ğŸ“± Social Media","design_branding"===a.proposed_project_vertical&&"ğŸ¨ Design & Branding"]})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Task: ",a.title]}),a.users?.full_name&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["From: ",a.users.full_name," (",a.users.email,")"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Created ",new Date(a.created_at).toLocaleString()]}),a.projects?.name&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Currently mapped: ",a.projects.name]})]}),(0,b.jsx)("div",{className:"w-48",children:(0,b.jsxs)(A.Select,{value:ac[a.id]||"none",onValueChange:b=>ad({...ac,[a.id]:b}),children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{placeholder:"Attach to project (optional)"})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"none",children:"No project yet"}),U.map(a=>(0,b.jsx)(A.SelectItem,{value:a.id,children:a.name},a.id))]})]})})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Button,{size:"sm",variant:"default",disabled:ag,onClick:()=>aR(a.id,"approved"),children:"Approve"}),(0,b.jsx)(h.Button,{size:"sm",variant:"outline",disabled:ag,onClick:()=>aR(a.id,"rejected"),children:"Reject"})]})]},a.id))})})]}),U.length>0&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:"text-lg md:text-xl",children:"Service Breakdown"}),(0,b.jsx)(g.CardDescription,{className:"text-xs md:text-sm",children:"Projects by service vertical"})]}),(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:()=>T.push("/dashboard/analytics"),className:"w-full sm:w-auto",children:"View Analytics"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)(z.Tabs,{defaultValue:"video_production",className:"w-full",children:[(0,b.jsxs)(z.TabsList,{className:"flex flex-wrap",children:[(0,b.jsx)(z.TabsTrigger,{value:"video_production",children:"Video Production"}),(0,b.jsx)(z.TabsTrigger,{value:"social_media",children:"Social Media"}),(0,b.jsx)(z.TabsTrigger,{value:"design_branding",children:"Design & Branding"})]}),(0,b.jsx)(z.TabsContent,{value:"video_production",children:(0,b.jsx)("div",{className:"space-y-3",children:0===U.filter(a=>"video_production"===a.service_type).length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No video production projects yet"}):U.filter(a=>"video_production"===a.service_type).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>ap(a),children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.clients?.company_name||"No client"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.budget&&(0,b.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",a.budget.toLocaleString()]}),(0,b.jsx)(w.StatusBadge,{status:a.status})]})]},a.id))})}),(0,b.jsx)(z.TabsContent,{value:"social_media",children:(0,b.jsx)("div",{className:"space-y-3",children:0===U.filter(a=>"social_media"===a.service_type).length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No social media projects yet"}):U.filter(a=>"social_media"===a.service_type).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>ap(a),children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.clients?.company_name||"No client"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.budget&&(0,b.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",a.budget.toLocaleString()]}),(0,b.jsx)(w.StatusBadge,{status:a.status})]})]},a.id))})}),(0,b.jsx)(z.TabsContent,{value:"design_branding",children:(0,b.jsx)("div",{className:"space-y-3",children:0===U.filter(a=>"design_branding"===a.service_type).length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No design & branding projects yet"}):U.filter(a=>"design_branding"===a.service_type).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>ap(a),children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.clients?.company_name||"No client"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.budget&&(0,b.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",a.budget.toLocaleString()]}),(0,b.jsx)(w.StatusBadge,{status:a.status})]})]},a.id))})})]})})]}),(0,b.jsxs)("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:"text-lg md:text-xl",children:"Recent Clients"}),(0,b.jsx)(g.CardDescription,{className:"text-xs md:text-sm",children:"Latest client additions"})]})}),(0,b.jsx)(g.CardContent,{children:0===aU.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(p.Users,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No clients yet"})]}):(0,b.jsx)("div",{className:"space-y-3",children:aU.map(a=>{let c=U.filter(b=>b.client_id===a.id),d=[...new Set(c.map(a=>a.service_type))];return(0,b.jsxs)("div",{className:"p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.company_name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.contact_person})]}),(0,b.jsxs)(y.Badge,{variant:"outline",className:"text-xs",children:[c.length," ",1===c.length?"project":"projects"]})]}),d.length>0&&(0,b.jsx)("div",{className:"flex gap-1 flex-wrap",children:d.map(a=>{let c=C.SERVICE_TYPES[a];return(0,b.jsxs)(y.Badge,{variant:"outline",className:"text-xs",children:[c.icon," ",c.label]},a)})})]},a.id)})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{className:"text-lg md:text-xl",children:"Recent Invoices"}),(0,b.jsx)(g.CardDescription,{className:"text-xs md:text-sm",children:"Latest billing activity"})]}),(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:()=>T.push("/dashboard/invoices"),className:"w-full sm:w-auto",children:"View All"})]}),(0,b.jsx)(g.CardContent,{children:0===aT.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(m.FileText,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No invoices yet"}),(0,b.jsxs)(h.Button,{onClick:()=>T.push("/dashboard/invoices"),className:"mt-4",size:"sm",children:[(0,b.jsx)(n.Plus,{className:"h-4 w-4 mr-2"}),"Create Invoice"]})]}):(0,b.jsx)("div",{className:"space-y-3",children:aT.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors",onClick:()=>T.push("/dashboard/invoices"),children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.invoice_number}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.clients?.company_name||"No client"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",a.total?.toLocaleString()]}),(0,b.jsx)(w.StatusBadge,{status:a.status})]})]},a.id))})})]})]}),aK.overdueInvoices>0&&(Q=W.filter(a=>"pending"===a.status&&a.due_date&&new Date(a.due_date)<new Date),(0,b.jsxs)(g.Card,{className:"border-red-500/50 bg-red-500/5",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.AlertCircle,{className:"h-5 w-5 text-red-500"}),(0,b.jsx)(g.CardTitle,{className:"text-red-500",children:"Overdue Invoices"})]}),(0,b.jsx)(g.CardDescription,{children:"These invoices are past their due date"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"space-y-3",children:Q.slice(0,5).map(a=>{let c=Math.floor((new Date().getTime()-new Date(a.due_date).getTime())/864e5);return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-red-500/20 bg-background cursor-pointer hover:bg-accent transition-colors",onClick:()=>T.push("/dashboard/invoices"),children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.invoice_number}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.clients?.company_name||"No client"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:["â‚¹",a.total?.toLocaleString()]}),(0,b.jsxs)(y.Badge,{variant:"destructive",className:"text-xs",children:[c," day",1!==c?"s":""," overdue"]})]})]},a.id)})}),Q.length>5&&(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",className:"w-full mt-4",onClick:()=>T.push("/dashboard/invoices"),children:["View all ",Q.length," overdue invoices"]})]})]})),$.length>0&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Upcoming Milestones"}),(0,b.jsx)(g.CardDescription,{children:"Important deadlines to track"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:$.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(o.Calendar,{className:"h-4 w-4 mt-1 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.title}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.projects?.name||"No project"})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.due_date?new Date(a.due_date).toLocaleDateString():"No date"}),(0,b.jsx)(y.Badge,{variant:"outline",className:"text-xs mt-1",children:a.status})]})]},a.id))})})]}),(0,b.jsx)(i.Dialog,{open:!!ao,onOpenChange:a=>!a&&ap(null),children:(0,b.jsxs)(i.DialogContent,{className:"max-w-4xl max-h-[85vh] overflow-y-auto rounded-2xl bg-white/10 dark:bg-white/5 border-white/20 ring-1 ring-white/10 supports-[backdrop-filter]:backdrop-blur-xl",children:[(0,b.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-0 top-0 h-1/3 bg-gradient-to-b from-white/20 to-transparent dark:from-white/10 dark:to-transparent rounded-t-2xl"}),ao&&(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsx)(i.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(i.DialogTitle,{className:"text-2xl",children:ao.name}),(0,b.jsxs)(i.DialogDescription,{className:"mt-2",children:["Client: ",ao.clients?.company_name||"No client"]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(y.Badge,{variant:(a=>{switch(a){case"video_production":return"default";case"social_media":default:return"secondary";case"design_branding":return"outline"}})(ao.service_type),children:[(0,b.jsx)("span",{className:"mr-1",children:C.SERVICE_TYPES[ao.service_type]?.icon}),C.SERVICE_TYPES[ao.service_type]?.label||ao.service_type]}),(0,b.jsx)(w.StatusBadge,{status:ao.status})]})]})}),(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:"Project Overview"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[ao.budget&&(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(k.DollarSign,{className:"h-3 w-3"}),"Budget"]}),(0,b.jsxs)("p",{className:"font-semibold",children:["â‚¹",ao.budget.toLocaleString()]})]}),ao.start_date&&(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(o.Calendar,{className:"h-3 w-3"}),"Start Date"]}),(0,b.jsx)("p",{className:"font-semibold",children:new Date(ao.start_date).toLocaleDateString()})]}),ao.deadline&&(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(o.Calendar,{className:"h-3 w-3"}),"Deadline"]}),(0,b.jsx)("p",{className:"font-semibold",children:new Date(ao.deadline).toLocaleDateString()})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-1",children:[(0,b.jsx)(q.TrendingUp,{className:"h-3 w-3"}),"Progress"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Progress,{value:ao.progress_percentage||0,className:"h-2 flex-1"}),(0,b.jsxs)("span",{className:"font-semibold text-sm",children:[ao.progress_percentage||0,"%"]})]})]})]})]}),ao.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Description"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:ao.description})]}),(0,b.jsx)(h.Button,{onClick:()=>{T.push(`/dashboard/projects?id=${ao.id}`),ap(null)},className:"w-full",children:"View Full Details"})]})]})]})})]})}function J(){let{user:a,loading:f}=(0,c.useAuth)(),g=(0,d.useRouter)();return((0,e.useEffect)(()=>{!f&&a&&("client"===a.role?g.push("/dashboard/client"):("employee"===a.role||"project_manager"===a.role)&&g.push("/dashboard/employee"))},[f,a,g]),f)?(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})}):a?.role==="admin"?(0,b.jsx)(I,{}):(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Redirecting..."})})}a.s(["default",()=>J],20731)}];

//# sourceMappingURL=app_dashboard_page_tsx_42ef5b16._.js.map